import{bG as e,bH as a,j as i}from"./main-DbCIA5nM.js";import{j as t,f as l,b as s,L as r}from"./vendor-X2E3PIZN.js";import{R as m}from"./quill.snow-BtYlbvM3.js";import{a as o}from"./utils-ZFgnvnbw.js";import{F as n}from"./index-BGrTmilS.js";import{B as d}from"./Breadcrumb-DZWgOyzs.js";import{R as p}from"./HomeOutlined-qdt4-xZj.js";import{S as g}from"./index-TlfG7RwS.js";import{U as u,R as j}from"./index-1EwFYQPN.js";import{B as h}from"./index-CvhnQ2ZS.js";import{I as c}from"./index-C8xsCgg9.js";import{s as x}from"./index-BQxUT-WV.js";import"./isEqual-12EnfSUl.js";import"./toArray-DIarnBRF.js";import"./objectSpread2-C2mPdFQ-.js";import"./AntdIcon-Bc_RgQsY.js";import"./index-BJvm14ET.js";import"./CheckCircleFilled-vSnFSXRd.js";import"./ExclamationCircleFilled-jOtwz4nB.js";import"./dropdown-C2Lyn6ws.js";import"./index-Cie-PtDs.js";import"./getAllowClear-CF0z5FWe.js";import"./CheckOutlined-qoM0f-f3.js";import"./Input-DzV7KJ8a.js";import"./fade-CZ8b_ilM.js";import"./DeleteOutlined-D5hKN4qo.js";import"./DownloadOutlined-B6iPWVSX.js";import"./EyeOutlined-D6toRaq1.js";import"./TextArea-BQkixvnv.js";import"./InfoCircleFilled-BiVI0bqr.js";const{Option:f}=g,N=()=>{const{id:N}=t(),b=l(),[F]=n.useForm(),[I,S]=s.useState(!1),[w,y]=s.useState(!1),[v,P]=s.useState([]),{data:C,isLoading:L,refetch:E}=e(N),[O]=a();s.useEffect((()=>{(async()=>{try{const e=await o.get("/api/menulist/get-menu");e.data.success&&P(e.data.data)}catch(e){x.error("Failed to fetch menu list")}})()}),[]),s.useEffect((()=>{C&&F.setFieldsValue({title:C.title,altName:C.altName,details:C.details,imgName:C.imgName,pageSlug:C.pageSlug||"",image:C.image?[{name:C.imgName,url:`/api/image/download/${C.image}`}]:[],photo:C.photo?[{name:C.photoName,url:`/api/photo/download/${C.photo}`}]:[]})}),[C,F]);return L?i.jsx("div",{children:"Loading..."}):i.jsxs("div",{children:[i.jsxs(d,{style:{padding:"16px 24px"},children:[i.jsx(d.Item,{children:i.jsxs(r,{to:"/dashboard",children:[i.jsx(p,{})," Dashboard"]})}),i.jsx(d.Item,{children:i.jsx(r,{to:"/banner-table",children:"Banner Management"})}),i.jsx(d.Item,{children:"Edit Banner"})]}),i.jsxs("div",{style:{padding:"24px"},children:[i.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Edit Banner"}),i.jsxs(n,{form:F,layout:"vertical",onFinish:async e=>{try{if(!e.title?.trim())return void x.error("Title is required");if(!e.altName?.trim())return void x.error("Alt Name is required");if(!e.pageSlug)return void x.error("Page Slug is required");const a=new FormData;I&&e.image?.[0]?.originFileObj?(a.append("image",e.image[0].originFileObj),a.append("imgName",e.image[0].name)):a.append("imgName",e.imgName||C.imgName),w&&e.photo?.[0]?.originFileObj?a.append("photo",e.photo[0].originFileObj):C.photo&&a.append("photo",C.photo),a.append("title",e.title.trim()),a.append("altName",e.altName.trim()),a.append("details",e.details?.trim()||""),a.append("pageSlug",e.pageSlug),await O({id:N,bannerData:a}),x.success("Banner updated successfully"),E(),b("/banner-table")}catch(a){x.error("Failed to update banner")}},initialValues:{title:C?.title||"",altName:C?.altName||"",details:C?.details||"",imgName:C?.imgName||"",pageSlug:C?.pageSlug||"",image:C?.image?[{name:C.imgName,url:`/api/image/download/${C.image}`}]:[],photo:C?.photo?[{name:C.photoName,url:`/api/image/download/${C.photo}`}]:[]},children:[i.jsx(n.Item,{name:"pageSlug",label:"Page Slug",rules:[{required:!0,message:"Please select a Page Slug!"}],children:i.jsx(g,{placeholder:"Select Page Slug",children:v.map((e=>i.jsx(f,{value:e.parent.path,children:e.parent.name},e._id)))})}),i.jsx(n.Item,{name:"image",label:"Banner Image",valuePropName:"fileList",getValueFromEvent:e=>e&&e.fileList,children:i.jsx(u,{maxCount:1,listType:"picture",beforeUpload:()=>!1,onChange:e=>{S(!0),F.setFieldsValue({imgName:e.file.name,image:e.fileList})},defaultFileList:C?.image?[{name:C.imgName,url:`/api/image/download/${C.image}`}]:[],children:i.jsx(h,{icon:i.jsx(j,{}),children:I?"Change Image":"Upload New Image"})})}),i.jsx(n.Item,{name:"photo",label:"Photo",valuePropName:"fileList",getValueFromEvent:e=>e&&e.fileList,children:i.jsx(u,{maxCount:1,listType:"picture",beforeUpload:()=>!1,onChange:e=>{y(!0),F.setFieldsValue({photo:e.fileList})},defaultFileList:C?.photo?[{name:C.photoName,url:`/api/photo/download/${C.photo}`}]:[],children:i.jsx(h,{icon:i.jsx(j,{}),children:w?"Change Photo":"Upload New Photo"})})}),i.jsx(n.Item,{name:"imgName",label:"Image Name",rules:[{required:!0,message:"Please input image name!"}],children:i.jsx(c,{disabled:I})}),i.jsx(n.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Please input title!"}],children:i.jsx(c,{})}),i.jsx(n.Item,{name:"altName",label:"Alt Name",rules:[{required:!0,message:"Please input alt name!"}],children:i.jsx(c,{})}),i.jsx(n.Item,{name:"details",label:"Details",rules:[{message:"Please input details!"}],children:i.jsx(m,{theme:"snow"})}),i.jsx(n.Item,{children:i.jsx(h,{type:"primary",htmlType:"submit",children:"Update"})})]})]})]})};export{N as default};
//# sourceMappingURL=EditBannerForm-DCtaF76Q.js.map
