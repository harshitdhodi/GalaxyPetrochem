import{j as e,aJ as s,ap as a,I as t,B as l,bd as i,ba as r,ax as c}from"./main-CYgOQvaw.js";import{b as n,R as o}from"./vendor-BCMiqwDy.js";import{F as d}from"./Table-DE-uw6w5.js";import{S as m}from"./index-DXGSnt5L.js";import{S as h}from"./index-DgxO-2IE.js";import{B as u}from"./index-KxCZag0G.js";import{B as p}from"./react-toastify.esm-BsgWllsW.js";import{B as x}from"./BreadCrumb-CCpOg2-Q.js";import"./utils-ZFgnvnbw.js";import"./styleChecker-CIIr7Nl-.js";import"./dropdown-Bj_SuELm.js";import"./EllipsisOutlined-Cze1ZPQm.js";import"./getAllowClear-BT_cn9Om.js";import"./index-CjYu-pHv.js";import"./Input-rDQgC5HY.js";import"./CheckOutlined-D_PsN1dT.js";import"./chevron-right-BHJrePhs.js";function j({chemicals:s,onRemoveChemical:a}){const[t,l]=n.useState(1),[i,r]=n.useState(10),c=Math.ceil((s?.length||0)/i),o=(t-1)*i,p=o+i,x=s?.slice(o,p),j=[{title:"Action",dataIndex:"action",render:(s,t)=>e.jsx(u,{type:"primary",danger:!0,size:"small",onClick:()=>a(t),children:"Delete"})},{title:"Chemical Name",dataIndex:"name"},{title:"CAS Number",dataIndex:"cas_number"}];return e.jsxs("div",{className:"border rounded-md mt-4 p-4",children:[e.jsx(d,{columns:j,dataSource:x,rowKey:"_id",pagination:!1}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Items per page:"," ",e.jsx(m,{value:i,onChange:e=>{r(e),l(1)},options:[{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"}],style:{width:80}})]}),e.jsxs(h,{children:[e.jsx(u,{type:"default",size:"small",onClick:()=>l(t-1),disabled:1===t,children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[o+1," - ",Math.min(p,s?.length||0)," of"," ",s?.length||0]}),e.jsx(u,{type:"default",size:"small",onClick:()=>l(t+1),disabled:t===c,children:"Next"})]})]})]})}function g({selectedCustomer:i,refetchCustomer:r}){const[c,o]=n.useState(""),[d,m]=n.useState(""),[h,u]=n.useState(null),{data:x,isLoading:j}=s(d.charAt(0),{skip:0===d.length}),[g,{isLoading:b}]=a();return e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(t,{placeholder:"Search Chemical",value:c,onChange:e=>{const s=e.target.value;o(s),m(s)},className:"w-full mb-4",disabled:!i}),j&&e.jsx("div",{className:"absolute top-2 right-4 text-sm text-gray-500",children:"Loading..."})]}),d&&x?.length>0&&e.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:x.map((s=>e.jsx("li",{onClick:()=>(e=>{u(e),o(e.name),m("")})(s),className:"p-2 hover:bg-gray-200 cursor-pointer",children:s.name},s._id)))}),e.jsx(l,{onClick:async()=>{if(h&&i)try{const e=h.id||h._id,s=i._id;await g({customerId:s,chemicalId:e}).unwrap(),o(""),u(null),await r(),p.success("Chemical added successfully")}catch(e){p.error(e.message||"Failed to add chemical")}else p.error("Please select both customer and chemical")},disabled:b||!h||!i,className:"mt-4 w-[10%] py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:b?"Adding...":"Add "})]})}function b({onSelectCustomer:s}){const[a,l]=n.useState(""),[o,d]=n.useState(""),[m,h]=n.useState(null),{data:u,isLoading:x,refetch:b}=i(o.charAt(0),{skip:0===o.length}),{data:f,refetch:v}=r(m?._id,{skip:!m?._id}),[C]=c(),y=f?.data||m;return e.jsxs("div",{className:"mt-4",children:[e.jsx(t,{placeholder:"Search Customer",value:a,onChange:e=>{const s=e.target.value;l(s),d(s)},className:"w-full mb-4"}),x?e.jsx("div",{children:"Loading..."}):o&&u&&u.length>0&&e.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:u.map((a=>e.jsx("li",{onClick:()=>(e=>{h(e),l(e.name),d(""),s(e)})(a),className:"p-2 hover:bg-gray-200 cursor-pointer",children:a.name},a._id)))}),e.jsx(g,{selectedCustomer:y,refetchCustomer:async()=>{await Promise.all([v(),b()])}}),y&&e.jsx(j,{chemicals:y.chemicalId||[],onRemoveChemical:async e=>{try{await C({customerId:m._id,chemicalId:e._id}).unwrap(),await Promise.all([v(),b()]),p.success("Chemical removed successfully")}catch(s){p.error("Failed to remove chemical")}}})]})}const f=[{label:"Dashboard",href:"/dashboard"},{label:"Chemical Mapping",href:null}];function v(){const[s,a]=o.useState(null),[t,l]=o.useState([]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ml-1",children:e.jsx(x,{items:f})}),e.jsxs("div",{className:"py-4 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-purple-700",children:"Assign Chemicals to Customer"}),e.jsx("div",{className:"space-y-4",children:e.jsx(b,{onSelectCustomer:e=>{a(e),l([])}})})]})]})}export{v as default};
//# sourceMappingURL=ChemicalMapping-Cbs8iF14.js.map
