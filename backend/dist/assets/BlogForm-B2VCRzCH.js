import{dH as e,dI as a,dJ as t,u as s,j as r,I as l,an as i,B as d}from"./main-CYgOQvaw.js";import{k as o,f as n,b as c}from"./vendor-BCMiqwDy.js";import{C as m}from"./chevron-right-BHJrePhs.js";import"./utils-ZFgnvnbw.js";function g(){const{id:g}=o(),u=n(),[h,p]=c.useState({title:"",date:"",details:"",image:[],alt:[],imageTitle:[],slug:"",postedBy:"",visits:0,metatitle:"",metadescription:"",metakeywords:"",metacanonical:"",metalanguage:"",metaschema:"",otherMeta:"",url:"",priority:0,changeFreq:"",lastmod:new Date,status:"",category:"",createdAt:new Date,updatedAt:new Date}),[x,j]=c.useState([]),{data:y,isLoading:b,error:f}=e(g,{skip:!g}),[v,{isLoading:w}]=a(),[N,{isLoading:k}]=t(),{data:C}=s(),[D,A]=c.useState({}),B=e=>{const{name:a,value:t}=e.target;A((e=>({...e,[a]:""}))),p((e=>{const s={...e,[a]:t};return"title"===a&&(s.slug=t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")),s}))};return c.useEffect((()=>{y&&(p({title:y.title||"",date:y.date||"",details:y.details||"",image:[],alt:y.alt||[],imageTitle:y.imageTitle||[],slug:y.slug||"",postedBy:y.postedBy||"",visits:y.visits||0,metatitle:y.metatitle||"",metadescription:y.metadescription||"",metakeywords:y.metakeywords||"",metacanonical:y.metacanonical||"",metalanguage:y.metalanguage||"",metaschema:y.metaschema||"",otherMeta:y.otherMeta||"",url:y.url||"",priority:y.priority||0,changeFreq:y.changeFreq||"",lastmod:y.lastmod||new Date,status:y.status||"",category:y.category?._id||"",createdAt:y.createdAt||new Date,updatedAt:y.updatedAt||new Date}),y.image&&Array.isArray(y.image)&&j(y.image.map((e=>`/api/image/download/${e}`))))}),[y]),c.useEffect((()=>()=>{x.forEach((e=>URL.revokeObjectURL(e)))}),[x]),g&&b?r.jsx("div",{children:"Loading..."}):f?r.jsxs("div",{children:["Error: ",f.message||"An error occurred"]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center gap-2 mb-4 text-sm",children:[r.jsx("span",{onClick:()=>u("/dashboard"),className:"cursor-pointer hover:text-primary",children:"Dashboard"}),r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{onClick:()=>u("/blog-table"),className:"cursor-pointer hover:text-primary",children:"Blogs"}),r.jsx(m,{className:"h-4 w-4"}),r.jsx("span",{className:"text-muted-foreground",children:g?"Edit Blog":"Create Blog"})]}),r.jsxs("form",{onSubmit:async e=>{e.preventDefault();const a={};if(h.title.trim()||(a.title="Title is required"),h.category||(a.category="Category is required"),h.date||(a.date="Date is required"),h.details.trim()||(a.details="Details are required"),Object.keys(a).length>0)return void A(a);const t=new FormData;Object.entries(h).forEach((([e,a])=>{"image"===e?a.forEach((e=>{t.append("image",e)})):Array.isArray(a)?a.forEach((a=>{t.append(e,a)})):t.append(e,a.toString())})),g&&t.append("id",g);try{g?await N({id:g,formData:t}).unwrap():await v(t).unwrap(),u("/blog-table")}catch(s){}},className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium",children:"Blog Category"}),r.jsxs("select",{name:"category",value:h.category,onChange:e=>p((a=>({...a,category:e.target.value}))),className:`w-full rounded-md border ${D.category?"border-red-500":"border-gray-300"} p-2`,required:!0,children:[r.jsx("option",{value:"",children:"Select a category"}),C?.map((e=>r.jsx("option",{value:e._id,children:e.category},e._id)))]}),D.category&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:D.category})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium",children:"Title"}),r.jsx(l,{name:"title",value:h.title,onChange:B,placeholder:"Enter blog title",required:!0,className:D.title?"border-red-500":""}),D.title&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:D.title})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium",children:"Date"}),r.jsx(l,{type:"date",name:"date",value:h.date,onChange:B,required:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium",children:"Details"}),r.jsx(i,{modules:{toolbar:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link","image"],["clean"]]},theme:"snow",value:h.details,onChange:e=>{p((a=>({...a,details:e})))},placeholder:"Enter blog details"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium",children:"Images"}),r.jsx(l,{type:"file",multiple:!0,onChange:e=>{const a=Array.from(e.target.files||[]);p((e=>({...e,image:a})));const t=a.map((e=>URL.createObjectURL(e)));j(t)}}),r.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:x.map(((e,a)=>r.jsx("img",{src:e,alt:`Preview ${a+1}`,className:"h-16 w-16 object-cover rounded"},a)))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium",children:"Slug"}),r.jsx(l,{name:"slug",value:h.slug,onChange:B,placeholder:"Slug will be generated automatically",readOnly:!0})]},"slug"),["alt","imageTitle","postedBy","metatitle","metadescription","metakeywords","metacanonical","metalanguage","metaschema","otherMeta","priority","status"].map((e=>r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium",children:e.charAt(0).toUpperCase()+e.slice(1)}),r.jsx(l,{name:e,value:h[e],onChange:B,placeholder:`Enter ${e}`})]},e))),r.jsxs("div",{className:"flex justify-end space-x-4",children:[r.jsx(d,{type:"button",variant:"ghost",onClick:()=>u("/blogs"),children:"Cancel"}),r.jsx(d,{type:"submit",disabled:w||k,children:g?"Update Blog":"Create Blog"})]})]})]})}export{g as default};
//# sourceMappingURL=BlogForm-B2VCRzCH.js.map
