import{f as K,bn as R,dX as Y,u as H,r as c,j as e,C as W,bi as q,bj as z,bk as O,aU as r,I as h,B as C}from"./index-CkLbobrs-1746075606789.js";import{u as X}from"./index.esm-DRLGHeDk-1746075606789.js";import{t as G,o as Q,a as $,s as n,l as J}from"./index-BUOHYM1B-1746075606789.js";import{T as L}from"./textarea-Dm-NYi_g-1746075606789.js";import{S as f,a as y,b as N,c as v,d as S}from"./select-Sc1OOJvy-1746075606789.js";import{B as Z}from"./BreadCrumb-CtV5fgkw-1746075606789.js";import{B as p}from"./react-toastify.esm-prKCgRqr-1746075606789.js";import"./index-DgDUR7tF-1746075606789.js";import"./chevron-up-DP_Yp7Xx-1746075606789.js";import"./chevron-right-CeD3p5wr-1746075606789.js";const _=Q({name:n().min(1,"Customer name is required"),contactPerson:n().optional(),email:n().email("Invalid email address"),mobile:n().min(1,"Mobile number is required"),website:n().url("Invalid URL").optional().or(J("")),address:n().optional(),country:n().optional(),state:n().optional(),city:n().optional(),description:n().optional(),image:$().optional()}),ee=[{label:"Dashboard",href:"/dashboard"},{label:"Customer Table",href:"/customer-table"},{label:"Edit Customer",href:null}];function ue(){const{id:j}=K(),{data:l,isLoading:P}=R(j),[T,{isLoading:w}]=Y(),F=H(),[A]=c.useState([{isoCode:"US",name:"United States"},{isoCode:"CA",name:"Canada"},{isoCode:"UK",name:"United Kingdom"},{isoCode:"IN",name:"India"},{isoCode:"AU",name:"Australia"}]),B={US:[{isoCode:"NY",name:"New York"},{isoCode:"CA",name:"California"},{isoCode:"TX",name:"Texas"}],IN:[{isoCode:"MH",name:"Maharashtra"},{isoCode:"DL",name:"Delhi"},{isoCode:"KA",name:"Karnataka"}]},M={NY:[{name:"New York City"},{name:"Buffalo"}],CA:[{name:"Los Angeles"},{name:"San Francisco"}],MH:[{name:"Mumbai"},{name:"Pune"}]},[U,E]=c.useState([]),[I,g]=c.useState([]),{register:o,handleSubmit:k,watch:u,setValue:i,reset:se,formState:{errors:t}}=X({resolver:G(_),defaultValues:{name:"",contactPerson:"",email:"",mobile:"",website:"",address:"",country:"",state:"",city:"",description:"",image:null}}),d=u("country"),m=u("state"),x=u("image");c.useEffect(()=>{if(d){const s=B[d]||[];E(s),l||(i("state",""),i("city",""))}else E([]),g([])},[d,i,l]),c.useEffect(()=>{if(m){const s=M[m]||[];g(s),l||i("city","")}else g([])},[m,i,l]),c.useEffect(()=>{l!=null&&l.data&&["name","contactPerson","email","mobile","website","address","country","state","city","description","image"].forEach(a=>{l.data[a]!==void 0&&i(a,l.data[a]||"")})},[l,i]);const V=s=>{const a=s.target.files[0];if(a){if(!a.type.startsWith("image/")){p.error("Please upload an image file");return}if(a.size>5*1024*1024){p.error("Image size should be less than 5MB");return}i("image",a)}},D=async s=>{try{const a=new FormData;Object.keys(s).forEach(b=>{b!=="image"&&a.append(b,s[b]||"")}),s.image instanceof File&&a.append("image",s.image),a.append("id",j);const ae=await T({id:j,data:a}).unwrap();p.success("Customer updated successfully"),F("/customer-table")}catch(a){console.error("Error structure:",a),p.error(a.message||"Failed to update customer")}};return P?e.jsx("div",{children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ml-1",children:e.jsx(Z,{items:ee})}),e.jsxs(W,{className:"w-full mt-4 mx-auto",children:[e.jsx(q,{children:e.jsx(z,{className:"text-xl text-purple-700",children:"Edit Customer"})}),e.jsx(O,{children:e.jsxs("form",{onSubmit:k(D),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{htmlFor:"name",children:["Customer Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(h,{id:"name",...o("name"),className:t.name?"border-red-500":""}),t.name&&e.jsx("p",{className:"text-red-500 text-sm",children:t.name.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"contactPerson",children:"Contact Person"}),e.jsx(h,{id:"contactPerson",...o("contactPerson")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{htmlFor:"email",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(h,{id:"email",type:"email",...o("email"),className:t.email?"border-red-500":""}),t.email&&e.jsx("p",{className:"text-red-500 text-sm",children:t.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{htmlFor:"mobile",children:["Mobile Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(h,{id:"mobile",...o("mobile"),className:t.mobile?"border-red-500":""}),t.mobile&&e.jsx("p",{className:"text-red-500 text-sm",children:t.mobile.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"website",children:"Website"}),e.jsx(h,{id:"website",type:"url",...o("website"),className:t.website?"border-red-500":""}),t.website&&e.jsx("p",{className:"text-red-500 text-sm",children:t.website.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"country",children:"Country"}),e.jsxs(f,{value:d,onValueChange:s=>i("country",s),children:[e.jsx(y,{children:e.jsx(N,{placeholder:"Select Country"})}),e.jsx(v,{children:A.map(s=>e.jsx(S,{value:s.isoCode,children:s.name},s.isoCode))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"state",children:"State/Province"}),e.jsxs(f,{value:m,onValueChange:s=>i("state",s),disabled:!d||U.length===0,children:[e.jsx(y,{children:e.jsx(N,{placeholder:"Select State"})}),e.jsx(v,{children:U.map(s=>e.jsx(S,{value:s.isoCode,children:s.name},s.isoCode))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"city",children:"City"}),e.jsxs(f,{value:u("city"),onValueChange:s=>i("city",s),disabled:!m||I.length===0,children:[e.jsx(y,{children:e.jsx(N,{placeholder:"Select City"})}),e.jsx(v,{children:I.map(s=>e.jsx(S,{value:s.name,children:s.name},s.name))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"address",children:"Address"}),e.jsx(L,{id:"address",className:"min-h-[100px]",...o("address")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Upload image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-lg p-4 text-center",children:[e.jsx("div",{className:"w-32 h-32 mx-auto mb-4",children:e.jsx("img",{src:x instanceof File?URL.createObjectURL(x):x?`/api/logo/download/${x}`:"/placeholder.svg",alt:"image preview",className:"w-full h-full object-contain"})}),e.jsx(C,{type:"button",variant:"outline",className:"bg-green-500 text-white hover:bg-green-600",onClick:()=>document.getElementById("imageUpload").click(),children:"Add image"}),e.jsx("input",{type:"file",id:"imageUpload",accept:"image/*",onChange:V,className:"hidden"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"description",children:"Description"}),e.jsx(L,{id:"description",...o("description"),className:"min-h-[200px]",placeholder:"Enter customer description"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(C,{type:"submit",disabled:w,className:"bg-green-500 text-white hover:bg-green-600",children:w?"Saving...":"Save"}),e.jsx(C,{type:"button",variant:"destructive",onClick:()=>F("/customer-table"),children:"Cancel"})]})]})})]})]})}export{ue as default};
