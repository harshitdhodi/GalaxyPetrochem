import{ao as e,j as t,I as a,B as s,at as i,b8 as l,b9 as n}from"./main-CYgOQvaw.js";import{b as r,R as o}from"./vendor-BCMiqwDy.js";import{a as c}from"./utils-ZFgnvnbw.js";import{F as d,P as m}from"./Table-DE-uw6w5.js";import{M as h}from"./index-BjoAxhQz.js";import{B as u}from"./index-KxCZag0G.js";import"./styleChecker-CIIr7Nl-.js";import"./index-DXGSnt5L.js";import"./EllipsisOutlined-Cze1ZPQm.js";import"./dropdown-Bj_SuELm.js";import"./getAllowClear-BT_cn9Om.js";import"./CheckOutlined-D_PsN1dT.js";import"./Input-rDQgC5HY.js";import"./index-DgxO-2IE.js";import"./index-CjYu-pHv.js";import"./CheckCircleFilled-Cv6hAgl9.js";import"./ExclamationCircleFilled-DLWZbO_o.js";import"./InfoCircleFilled-D_WbiPnY.js";import"./ActionButton-CpH6NjgB.js";import"./Skeleton-eQTlzOGc.js";function p({selectedSupplier:i,onAddChemical:l}){const[n,o]=r.useState(""),[d,m]=r.useState(""),[h,u]=r.useState(null),[p,x]=r.useState([]),[j,g]=r.useState(!1),[f,{isLoading:S}]=e();return t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(a,{placeholder:"Search Chemical",value:n,onChange:e=>{const t=e.target.value;o(t),t.trim()?(m(t),(async e=>{if(e){g(!0);try{const t=await c.get(`/api/chemical/getChemicalByCategoryAndAlphabet?alphabet=${e}`);x(t.data)}catch(t){x([])}finally{g(!1)}}})(t.charAt(0))):(m(""),x([]))},className:"w-full mb-4",disabled:!i}),j&&t.jsx("div",{className:"absolute top-2 right-4 text-sm text-gray-500",children:"Loading..."})]}),d&&p?.length>0&&t.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:p.map((e=>t.jsx("li",{onClick:()=>(e=>{u(e),o(e.name),m("")})(e),className:"p-2 hover:bg-gray-200 cursor-pointer border-b last:border-b-0",children:e.name},e._id)))}),0===p?.length&&!j&&d&&t.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),t.jsx(s,{onClick:async()=>{if(h&&i)try{const e=h._id,t=i._id;await f({supplierId:t,chemical_ids:[e]}).unwrap(),u(null),o(""),l&&l()}catch(e){alert(`Failed to add chemical: ${e.message||"Unknown error occurred"}`)}},disabled:S||!h||!i,className:"mt-4 w-fit py-2 bg-blue-500 text-white rounded hover:bg-blue-600 "+(S?"opacity-50 cursor-not-allowed":""),children:S?"Adding...":"Add Chemical"})]})}function x({chemicals:e,refetch:a,supplierId:s,onRemoveChemical:l}){const[n,o]=r.useState(1),[c,p]=r.useState(10),[x]=i(),[j,g]=r.useState(null),[f,S]=r.useState(!1);Math.ceil(e.length/c);const b=(n-1)*c,C=b+c,y=e.slice(b,C),v=[{title:"Action",dataIndex:"action",render:(e,a)=>t.jsx(u,{danger:!0,size:"small",onClick:()=>(e=>{g(e),S(!0)})(a),children:"Delete"})},{title:"Chemical Name",dataIndex:"name"},{title:"CAS Number",dataIndex:"cas_number"}];return t.jsxs("div",{className:"border rounded-md mt-4 p-4",children:[t.jsx(d,{dataSource:y,columns:v,rowKey:"_id",pagination:!1}),t.jsx(m,{current:n,total:e.length,pageSize:c,onChange:e=>o(e),showSizeChanger:!0,onShowSizeChange:(e,t)=>p(t),className:"mt-4 float-end pt-5"}),t.jsx(h,{title:"Confirm Deletion",open:f,onCancel:()=>S(!1),onOk:async()=>{if(s&&j)try{await x({supplierId:s,chemicalId:j._id}),l(j),a(),S(!1),g(null),1===y.length&&n>1&&o(1)}catch(e){}},okText:"Delete",okButtonProps:{danger:!0},children:t.jsxs("p",{children:['Are you sure you want to delete "',j?.name,'"?']})})]})}function j({onSelectSupplier:e}){const[s,i]=r.useState(""),[o,c]=r.useState(""),[d,m]=r.useState(null),{data:h,isLoading:u}=l(o.charAt(0),{skip:0===o.length}),{data:j,refetch:g,isFetching:f}=n(d?._id,{skip:!d});r.useEffect((()=>{j&&!f&&(m(j),"function"==typeof e&&e(j))}),[j,f,e]);const S=()=>{g()};return t.jsxs("div",{className:"mt-4",children:[t.jsx(a,{placeholder:"Search Supplier",value:s,onChange:e=>{const t=e.target.value;i(t),c(t)},className:"w-full mb-4"}),u?t.jsx("div",{children:"Loading..."}):o&&h&&h.length>0&&t.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:h.map((a=>t.jsx("li",{onClick:()=>(t=>{m(t),i(t.name),c(""),"function"==typeof e&&e(t)})(a),className:"p-2 hover:bg-gray-200 cursor-pointer",children:a.name},a.id)))}),0===h?.length&&!u&&o&&t.jsx("div",{className:"p-2 text-gray-500",children:"No Supplier found"}),f&&t.jsx("div",{className:"p-2 text-gray-500",children:"Refreshing supplier data..."}),t.jsx(p,{selectedSupplier:d,onAddChemical:S}),t.jsx("div",{className:"mt-4",children:t.jsx(x,{chemicals:d?.chemical_ids||[],refetch:g,onRemoveChemical:S,supplierId:d?._id})})]})}function g(){const[e,a]=o.useState(null),[s,i]=o.useState([]);return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-purple-700",children:"Assign Chemicals to Supplier"}),t.jsx("div",{className:"space-y-4",children:t.jsx(j,{onSelectCustomer:e=>{a(e),i([])}})})]})}export{g as default};
//# sourceMappingURL=ChemicalMapping-DIBirzLp.js.map
