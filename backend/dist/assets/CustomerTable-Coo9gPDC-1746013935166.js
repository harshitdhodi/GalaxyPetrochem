import{r as g,aT as G,j as e,av as A,ax as T,ay as k,az as _,I as f,B as b,g as H,bn as Q,aK as $,T as F,l as I,m as p,n as i,o as L,p as a,bo as U,aI as W,L as M,a_ as q}from"./index-BIIJyams-1746013935166.js";import{D as K,a as O,b as V,c as E}from"./dropdown-menu-DNNWB0uL-1746013935166.js";import{P}from"./plus-BOUfeicv-1746013935166.js";import{T as J}from"./trash-a7b5_PBM-1746013935166.js";import{B as X}from"./BreadCrumb-Kavfdr-v-1746013935166.js";import{C as Y}from"./chevron-up-DafRvSnb-1746013935166.js";import{E as Z}from"./ellipsis-vertical-BxFsnGkg-1746013935166.js";import"./index-C5D7rP3r-1746013935166.js";import"./chevron-right-DT-BXHYV-1746013935166.js";import"./check-Bw7T2Kpn-1746013935166.js";const R=({open:h,onOpenChange:n,customerId:x,onAddChemical:j,customerRefatch:c,refetch:C})=>{const[d,u]=g.useState(""),[t,N]=g.useState([]),{data:o,isLoading:w,error:S}=G(d,{skip:!d||d.length<2}),v=async()=>{const s=t.map(m=>m._id),r={id:x,chemicalId:s};try{await H.put(`/api/customer/addChemicalIdsToCustomer?id=${x}`,r,{headers:{"Content-Type":"application/json"}}),n(!1),j&&j(t),c(),C()}catch(m){console.error("Error adding chemicals:",m)}},D=s=>{t.some(r=>r._id===s._id)||N(r=>{const m=[...r,s];return u(""),m})},y=s=>{N(r=>r.filter(m=>m._id!==s)),C()};return e.jsx(A,{open:h,onOpenChange:s=>!s&&n(!1),children:e.jsxs(T,{className:"max-w-lg p-6",children:[e.jsx(k,{children:e.jsx(_,{className:"text-lg font-semibold text-[#3b1f91]",children:"Add Chemicals to Customer"})}),e.jsxs("div",{className:"mt-4",children:[e.jsx(f,{placeholder:"Search chemicals",value:d,onChange:s=>u(s.target.value),className:"w-full mb-4"}),w?e.jsx("div",{children:"Loading..."}):d&&o&&o.length>0&&e.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:o.filter(s=>!t.some(r=>r._id===s._id)).map(s=>e.jsx("li",{onClick:()=>D(s),className:"p-2 hover:bg-gray-200 cursor-pointer",children:s.name},s._id))}),(o==null?void 0:o.length)===0&&!w&&d&&e.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),e.jsx("div",{className:"mt-4",children:t.length>0&&e.jsx("div",{className:"space-y-2",children:t.map(s=>e.jsxs("div",{className:"flex justify-between items-center bg-gray-100 p-2 rounded",children:[e.jsx("span",{children:s.name}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>y(s._id),className:"text-red-500",children:"Remove"})]},s._id))})}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx(b,{onClick:v,className:"bg-[#3b1f91] hover:bg-purple-700",disabled:t.length===0,children:"+ Add Chemicals"}),e.jsx(b,{onClick:()=>n(!1),className:"bg-red-600 hover:bg-red-700",children:"Cancel"})]})]})]})})},ee=({customerId:h,customerName:n,open:x,onOpenChange:j,customerRefatch:c})=>{var s;const[C,d]=g.useState(!1),{data:u,isLoading:t,isError:N,refetch:o}=Q(h,{skip:!x}),[w,{isLoading:S}]=$(),v=r=>{console.log("Adding chemical:",r),d(!1)},D=async r=>{try{await w({customerId:h,chemicalId:r}),o()}catch(m){console.error("Error deleting chemical:",m)}};if(t)return e.jsx(A,{open:x,onOpenChange:j,children:e.jsxs(T,{children:[e.jsx(k,{children:e.jsx(_,{children:"Loading Chemicals..."})}),e.jsx("p",{children:"Fetching chemical data..."})]})});if(N)return e.jsx(A,{open:x,onOpenChange:j,children:e.jsxs(T,{children:[e.jsx(k,{children:e.jsx(_,{children:"Error Loading Chemicals"})}),e.jsx("p",{children:"Unable to fetch chemical data. Please try again."})]})});const y=((s=u==null?void 0:u.data)==null?void 0:s.chemicalId)||[];return e.jsxs(e.Fragment,{children:[e.jsx(A,{open:x,onOpenChange:j,children:e.jsxs(T,{className:"max-w-3xl",children:[e.jsx(k,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(_,{children:["Chemicals for ",n]}),e.jsxs(b,{className:"m-3",onClick:()=>d(!0),children:[e.jsx(P,{className:"mr-2 h-4 w-4"})," Add Chemical"]})]})}),y.length>0?e.jsxs(F,{children:[e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(i,{children:"Name"}),e.jsx(i,{children:"CAS Number"}),e.jsx(i,{children:"Actions"})," "]})}),e.jsx(L,{children:y.map(r=>e.jsxs(p,{children:[e.jsx(a,{children:r.name}),e.jsx(a,{children:r.cas_number}),e.jsx(a,{children:e.jsx(b,{variant:"destructive",size:"sm",onClick:()=>D(r._id),disabled:S,children:e.jsx(J,{})})})]},r._id))})]}):e.jsx("p",{className:"text-center py-4",children:"No chemicals found for this customer"})]})}),e.jsx(R,{open:C,onOpenChange:d,customerId:h,onAddChemical:v,customerRefatch:c,refetch:o})]})},se=({salesOrders:h=[]})=>e.jsxs(F,{children:[e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(i,{children:"Created Date"}),e.jsx(i,{children:"Order Number"}),e.jsx(i,{children:"Payment Status"}),e.jsx(i,{children:"Total Discount"}),e.jsx(i,{children:"Total Tax"}),e.jsx(i,{children:"Total Amount"})]})}),e.jsx(L,{children:h.length===0?e.jsx(p,{children:e.jsx(a,{colSpan:6,className:"text-center",children:"No Data Found"})}):h.map(n=>e.jsxs(p,{children:[e.jsx(a,{children:n.createdDate}),e.jsx(a,{children:n.orderNumber}),e.jsx(a,{children:n.paymentStatus}),e.jsx(a,{children:n.totalDiscount}),e.jsx(a,{children:n.totalTax}),e.jsx(a,{children:n.totalAmount})]},n.orderNumber))})]}),ae=[{label:"Dashboard",href:"/dashboard"},{label:"Customer Table",href:"/supplier-table"}],xe=()=>{const[h,n]=g.useState(null),[x,j]=g.useState(!1),[c,C]=g.useState(null),[d]=U(),[u,t]=g.useState(!1),[N,o]=g.useState(!1),{data:w,isLoading:S,error:v,refetch:D}=W(),y=w||[];if(S)return e.jsx("div",{children:"Loading..."});if(v)return e.jsx("div",{children:"Error loading customers"});const s=l=>{n(B=>B===l?null:l)},r=l=>{console.log(`Adding chemical: ${l}`)},m=l=>{C(l),j(!0)},z=async l=>{try{t(!0),await d(l),alert("Customer deleted successfully")}catch{alert("Failed to delete customer")}finally{t(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ml-1",children:e.jsx(X,{items:ae})}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-medium text-[#3b1f91]",children:"Customers"}),e.jsx(M,{to:"/customer-form",children:e.jsxs(b,{children:[e.jsx(P,{className:"mr-2 h-4 w-4 "}),"Add Customer"]})})]}),e.jsx("hr",{className:"border-[#3b1f91] border my-4"}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(F,{children:[e.jsx(I,{className:"bg-gray-100 ",children:e.jsxs(p,{children:[e.jsx(i,{className:"w-[50px] border-r-gray-300 bg-gray-100"}),e.jsx(i,{className:"text-black border-r-gray-300 font-semibold",children:"Name"}),e.jsx(i,{className:"text-black border-r-gray-300 font-semibold",children:"Contact Person"}),e.jsx(i,{className:"text-black border-r-gray-300 font-semibold",children:"Email"}),e.jsx(i,{className:"text-black border-r-gray-300 font-semibold",children:"Mobile/Phone"}),e.jsx(i,{className:"text-black border-r-gray-300 font-semibold",children:"Website"}),e.jsx(i,{className:"text-black  font-semibold",children:"Chemicals Count"})]})}),e.jsxs(L,{children:[e.jsxs(p,{className:"bg-gray-100",children:[e.jsx(a,{}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter name...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter contact...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter email...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter phone...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter website...",className:"max-w-sm"})}),e.jsx(a,{children:e.jsx(f,{placeholder:"Filter chemicals...",className:"max-w-sm"})})]}),y.map(l=>e.jsxs(e.Fragment,{children:[e.jsxs(p,{children:[e.jsx(a,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>s(l.id),children:h===l.id?e.jsx(Y,{className:"h-4 w-4"}):e.jsx(q,{className:"h-4 w-4"})}),e.jsxs(K,{children:[e.jsx(O,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"sm",children:e.jsx(Z,{className:"h-4 w-4"})})}),e.jsxs(V,{align:"end",children:[e.jsx(M,{to:`/edit-customer-form/${l._id}`,children:e.jsx(E,{children:"Edit"})}),e.jsx(E,{className:"text-red-600",onClick:()=>z(l._id),disabled:u,children:u?"Deleting...":"Delete"}),e.jsx(E,{onClick:()=>{C(l),o(!0)},children:"Add Chemical"})]})]})]})}),e.jsx(a,{children:l.name}),e.jsx(a,{children:l.contactPerson}),e.jsx(a,{children:l.email}),e.jsx(a,{children:l.phone}),e.jsx(a,{children:l.website}),e.jsx(a,{children:e.jsxs(b,{className:"hover:bg-[#4f359c]",variant:"secondary",size:"sm",onClick:()=>m(l),children:["Chemicals (",l.chemicalId.length,")"]})})]},l.id),h===l.id&&e.jsx(p,{children:e.jsx(a,{colSpan:9,children:e.jsx("div",{className:"p-4",children:e.jsx(se,{customerId:l._id})})})})]}))]})]})}),e.jsx(ee,{open:x,onOpenChange:j,customerName:c==null?void 0:c.name,customerId:c==null?void 0:c._id,onAddChemical:r,customerRefatch:D}),e.jsx(R,{open:N,onOpenChange:o,onAddChemical:r,customerId:c==null?void 0:c._id})]})]})};export{xe as default};
