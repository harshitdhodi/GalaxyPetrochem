import{H as e,j as s,D as a,k as r,l,m as c,I as i,B as n,ac as d,v as t,P as h,ad as o,s as m,Q as x}from"./main-DbCIA5nM.js";import{b as j,L as u}from"./vendor-X2E3PIZN.js";import{T as p,a as b,b as g,c as N,d as f,e as C}from"./table-DVNdpQ_I.js";import{D as v,a as y,b as w,c as k}from"./dropdown-menu-C0TLOZFq.js";import{a as _}from"./utils-ZFgnvnbw.js";import{T as I}from"./trash-BWKPVeJ4.js";import{B as S}from"./BreadCrumb-BYTrRWt1.js";import{C as A}from"./chevron-up-D_C2ouKf.js";import{E as F}from"./ellipsis-vertical-BYn5zANP.js";import"./index-BoWlxZtN.js";import"./chevron-right-BX1oQPFZ.js";import"./check-DSfnMMtB.js";const D=({open:d,onOpenChange:t,customerId:h,onAddChemical:o,customerRefatch:m,refetch:x})=>{const[u,p]=j.useState(""),[b,g]=j.useState([]),{data:N,isLoading:f,error:C}=e(u,{skip:!u||u.length<2});return s.jsx(a,{open:d,onOpenChange:e=>!e&&t(!1),children:s.jsxs(r,{className:"max-w-lg p-6",children:[s.jsx(l,{children:s.jsx(c,{className:"text-lg font-semibold text-[#3b1f91]",children:"Add Chemicals to Customer"})}),s.jsxs("div",{className:"mt-4",children:[s.jsx(i,{placeholder:"Search chemicals",value:u,onChange:e=>p(e.target.value),className:"w-full mb-4"}),f?s.jsx("div",{children:"Loading..."}):u&&N&&N.length>0&&s.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:N.filter((e=>!b.some((s=>s._id===e._id)))).map((e=>s.jsx("li",{onClick:()=>(e=>{b.some((s=>s._id===e._id))||g((s=>{const a=[...s,e];return p(""),a}))})(e),className:"p-2 hover:bg-gray-200 cursor-pointer",children:e.name},e._id)))}),0===N?.length&&!f&&u&&s.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),s.jsx("div",{className:"mt-4",children:b.length>0&&s.jsx("div",{className:"space-y-2",children:b.map((e=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-100 p-2 rounded",children:[s.jsx("span",{children:e.name}),s.jsx(n,{variant:"outline",size:"sm",onClick:()=>{return s=e._id,g((e=>e.filter((e=>e._id!==s)))),void x();var s},className:"text-red-500",children:"Remove"})]},e._id)))})}),s.jsxs("div",{className:"flex justify-between mt-4",children:[s.jsx(n,{onClick:async()=>{const e=b.map((e=>e._id)),s={id:h,chemicalId:e};try{await _.put(`/api/customer/addChemicalIdsToCustomer?id=${h}`,s,{headers:{"Content-Type":"application/json"}}),t(!1),o&&o(b),m(),x()}catch(a){}},className:"bg-[#3b1f91] hover:bg-purple-700",disabled:0===b.length,children:"+ Add Chemicals"}),s.jsx(n,{onClick:()=>t(!1),className:"bg-red-600 hover:bg-red-700",children:"Cancel"})]})]})]})})},O=({customerId:e,customerName:i,open:o,onOpenChange:m,customerRefatch:x})=>{const[u,v]=j.useState(!1),{data:y,isLoading:w,isError:k,refetch:_}=d(e,{skip:!o}),[S,{isLoading:A}]=t();if(w)return s.jsx(a,{open:o,onOpenChange:m,children:s.jsxs(r,{children:[s.jsx(l,{children:s.jsx(c,{children:"Loading Chemicals..."})}),s.jsx("p",{children:"Fetching chemical data..."})]})});if(k)return s.jsx(a,{open:o,onOpenChange:m,children:s.jsxs(r,{children:[s.jsx(l,{children:s.jsx(c,{children:"Error Loading Chemicals"})}),s.jsx("p",{children:"Unable to fetch chemical data. Please try again."})]})});const F=y?.data?.chemicalId||[];return s.jsxs(s.Fragment,{children:[s.jsx(a,{open:o,onOpenChange:m,children:s.jsxs(r,{className:"max-w-3xl",children:[s.jsx(l,{children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs(c,{children:["Chemicals for ",i]}),s.jsxs(n,{className:"m-3",onClick:()=>v(!0),children:[s.jsx(h,{className:"mr-2 h-4 w-4"})," Add Chemical"]})]})}),F.length>0?s.jsxs(p,{children:[s.jsx(b,{children:s.jsxs(g,{children:[s.jsx(N,{children:"Name"}),s.jsx(N,{children:"CAS Number"}),s.jsx(N,{children:"Actions"})," "]})}),s.jsx(f,{children:F.map((a=>s.jsxs(g,{children:[s.jsx(C,{children:a.name}),s.jsx(C,{children:a.cas_number}),s.jsx(C,{children:s.jsx(n,{variant:"destructive",size:"sm",onClick:()=>(async s=>{try{await S({customerId:e,chemicalId:s}),_()}catch(a){}})(a._id),disabled:A,children:s.jsx(I,{})})})]},a._id)))})]}):s.jsx("p",{className:"text-center py-4",children:"No chemicals found for this customer"})]})}),s.jsx(D,{open:u,onOpenChange:v,customerId:e,onAddChemical:e=>{v(!1)},customerRefatch:x,refetch:_})]})},T=({salesOrders:e=[]})=>s.jsxs(p,{children:[s.jsx(b,{children:s.jsxs(g,{children:[s.jsx(N,{children:"Created Date"}),s.jsx(N,{children:"Order Number"}),s.jsx(N,{children:"Payment Status"}),s.jsx(N,{children:"Total Discount"}),s.jsx(N,{children:"Total Tax"}),s.jsx(N,{children:"Total Amount"})]})}),s.jsx(f,{children:0===e.length?s.jsx(g,{children:s.jsx(C,{colSpan:6,className:"text-center",children:"No Data Found"})}):e.map((e=>s.jsxs(g,{children:[s.jsx(C,{children:e.createdDate}),s.jsx(C,{children:e.orderNumber}),s.jsx(C,{children:e.paymentStatus}),s.jsx(C,{children:e.totalDiscount}),s.jsx(C,{children:e.totalTax}),s.jsx(C,{children:e.totalAmount})]},e.orderNumber)))})]}),L=[{label:"Dashboard",href:"/dashboard"},{label:"Customer Table",href:"/supplier-table"}],z=()=>{const[e,a]=j.useState(null),[r,l]=j.useState(!1),[c,d]=j.useState(null),[t]=o(),[_,I]=j.useState(!1),[z,E]=j.useState(!1),{data:P,isLoading:R,error:B,refetch:H}=m(),$=P||[];if(R)return s.jsx("div",{children:"Loading..."});if(B)return s.jsx("div",{children:"Error loading customers"});const G=e=>{};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"ml-1",children:s.jsx(S,{items:L})}),s.jsxs("div",{className:"space-y-4 mt-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-xl font-medium text-[#3b1f91]",children:"Customers"}),s.jsx(u,{to:"/customer-form",children:s.jsxs(n,{children:[s.jsx(h,{className:"mr-2 h-4 w-4 "}),"Add Customer"]})})]}),s.jsx("hr",{className:"border-[#3b1f91] border my-4"}),s.jsx("div",{className:"rounded-md border",children:s.jsxs(p,{children:[s.jsx(b,{className:"bg-gray-100 ",children:s.jsxs(g,{children:[s.jsx(N,{className:"w-[50px] border-r-gray-300 bg-gray-100"}),s.jsx(N,{className:"text-black border-r-gray-300 font-semibold",children:"Name"}),s.jsx(N,{className:"text-black border-r-gray-300 font-semibold",children:"Contact Person"}),s.jsx(N,{className:"text-black border-r-gray-300 font-semibold",children:"Email"}),s.jsx(N,{className:"text-black border-r-gray-300 font-semibold",children:"Mobile/Phone"}),s.jsx(N,{className:"text-black border-r-gray-300 font-semibold",children:"Website"}),s.jsx(N,{className:"text-black  font-semibold",children:"Chemicals Count"})]})}),s.jsxs(f,{children:[s.jsxs(g,{className:"bg-gray-100",children:[s.jsx(C,{}),s.jsx(C,{children:s.jsx(i,{placeholder:"Filter name...",className:"max-w-sm"})}),s.jsx(C,{children:s.jsx(i,{placeholder:"Filter contact...",className:"max-w-sm"})}),s.jsx(C,{children:s.jsx(i,{placeholder:"Filter email...",className:"max-w-sm"})}),s.jsx(C,{children:s.jsx(i,{placeholder:"Filter phone...",className:"max-w-sm"})}),s.jsx(C,{children:s.jsx(i,{placeholder:"Filter website...",className:"max-w-sm"})}),s.jsx(C,{children:s.jsx(i,{placeholder:"Filter chemicals...",className:"max-w-sm"})})]}),$.map((r=>s.jsxs(s.Fragment,{children:[s.jsxs(g,{children:[s.jsx(C,{children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(n,{variant:"ghost",size:"sm",onClick:()=>{return e=r.id,void a((s=>s===e?null:e));var e},children:e===r.id?s.jsx(A,{className:"h-4 w-4"}):s.jsx(x,{className:"h-4 w-4"})}),s.jsxs(v,{children:[s.jsx(y,{asChild:!0,children:s.jsx(n,{variant:"ghost",size:"sm",children:s.jsx(F,{className:"h-4 w-4"})})}),s.jsxs(w,{align:"end",children:[s.jsx(u,{to:`/edit-customer-form/${r._id}`,children:s.jsx(k,{children:"Edit"})}),s.jsx(k,{className:"text-red-600",onClick:()=>(async e=>{try{I(!0),await t(e),alert("Customer deleted successfully")}catch(s){alert("Failed to delete customer")}finally{I(!1)}})(r._id),disabled:_,children:_?"Deleting...":"Delete"}),s.jsx(k,{onClick:()=>{d(r),E(!0)},children:"Add Chemical"})]})]})]})}),s.jsx(C,{children:r.name}),s.jsx(C,{children:r.contactPerson}),s.jsx(C,{children:r.email}),s.jsx(C,{children:r.phone}),s.jsx(C,{children:r.website}),s.jsx(C,{children:s.jsxs(n,{className:"hover:bg-[#4f359c]",variant:"secondary",size:"sm",onClick:()=>(e=>{d(e),l(!0)})(r),children:["Chemicals (",r.chemicalId.length,")"]})})]},r.id),e===r.id&&s.jsx(g,{children:s.jsx(C,{colSpan:9,children:s.jsx("div",{className:"p-4",children:s.jsx(T,{customerId:r._id})})})})]})))]})]})}),s.jsx(O,{open:r,onOpenChange:l,customerName:c?.name,customerId:c?._id,onAddChemical:G,customerRefatch:H}),s.jsx(D,{open:z,onOpenChange:E,onAddChemical:G,customerId:c?._id})]})]})};export{z as default};
//# sourceMappingURL=CustomerTable-BJhF8s4u.js.map
