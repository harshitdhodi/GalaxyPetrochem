{"version":3,"file":"EditTemplate-CDFvPXZd.js","sources":["../../src/email/template/EditTemplate.jsx"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport { useGetTemplateByIdQuery, useUpdateTemplateMutation } from \"@/slice/template/emailTemplate\";\r\nimport ReactQuill from \"react-quill\";\r\nimport \"react-quill/dist/quill.snow.css\";\r\nimport { useGetEmailCategoriesQuery } from \"@/slice/emailCategory/emailCategory\";\r\n\r\nconst EditTemplateForm = () => {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n  const { register, handleSubmit, reset, setValue, formState: { errors } } = useForm();\r\n\r\n  const [updateTemplate, { isLoading: isUpdating }] = useUpdateTemplateMutation();\r\n  const { data: template, isLoading: isFetching, error } = useGetTemplateByIdQuery(id, { skip: !id });\r\n  const { data: categories, isLoading: categoriesLoading } = useGetEmailCategoriesQuery();\r\nconsole.log(categories)\r\n  useEffect(() => {\r\n    if (template?.data) {\r\n      reset({\r\n        name: template.data.name,\r\n        subject: template.data.subject,\r\n        body: template.data.body,\r\n        category: template.data.category?._id || \"\" // Ensure category is correctly set\r\n      });\r\n      setValue(\"body\", template.data.body);\r\n    }\r\n  }, [template, reset, setValue]);\r\n\r\n  const onSubmit = async (data) => {\r\n    try {\r\n      await updateTemplate({ id, ...data }).unwrap();\r\n      navigate('/email-template-table');\r\n    } catch (error) {\r\n      alert(\"Failed to update template: \" + error.message);\r\n    }\r\n  };\r\n\r\n  const handleEditorChange = (value) => {\r\n    setValue(\"body\", value);\r\n  };\r\n\r\n  if (isFetching) return <div>Loading template...</div>;\r\n  if (error) return <div>Error fetching template: {error.message}</div>;\r\n\r\n  return (\r\n    <div className=\"p-4 mx-auto\">\r\n      <h1 className=\"text-xl font-bold mb-4\">Edit Template</h1>\r\n      <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-4\">\r\n      <div>\r\n          <label className=\"block text-sm font-medium mb-1\" htmlFor=\"category\">Category</label>\r\n          <select\r\n            id=\"category\"\r\n            {...register(\"category\", { required: \"Category is required\" })}\r\n            className=\"w-full border border-gray-300 rounded px-3 py-2\"\r\n          >\r\n            <option value=\"\">Select a category</option>\r\n            {!categoriesLoading && categories?.map((category) => (\r\n              <option key={category._id} value={category._id}>\r\n                {category.emailCategory}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          {errors.category && <p className=\"text-red-500 text-sm\">{errors.category.message}</p>}\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-1\" htmlFor=\"name\">Name</label>\r\n          <input\r\n            id=\"name\"\r\n            {...register(\"name\", { required: \"Name is required\" })}\r\n            className=\"w-full border border-gray-300 rounded px-3 py-2\"\r\n            placeholder=\"Enter template name\"\r\n          />\r\n          {errors.name && <p className=\"text-red-500 text-sm\">{errors.name.message}</p>}\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-1\" htmlFor=\"subject\">Subject</label>\r\n          <input\r\n            id=\"subject\"\r\n            {...register(\"subject\", { required: \"Subject is required\" })}\r\n            className=\"w-full border border-gray-300 rounded px-3 py-2\"\r\n            placeholder=\"Enter template subject\"\r\n          />\r\n          {errors.subject && <p className=\"text-red-500 text-sm\">{errors.subject.message}</p>}\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium mb-1\" htmlFor=\"body\">Body</label>\r\n          <ReactQuill\r\n            value={template?.data?.body || \"\"}\r\n            onChange={handleEditorChange}\r\n            placeholder=\"Enter template body\"\r\n            className=\"w-full border border-gray-300 rounded px-3 py-2\"\r\n          />\r\n          {errors.body && <p className=\"text-red-500 text-sm\">{errors.body.message}</p>}\r\n        </div>\r\n\r\n      \r\n        <button\r\n          type=\"submit\"\r\n          className={`w-1/4 bg-blue-500 text-white px-4 py-2 rounded ${isUpdating ? \"opacity-50\" : \"\"}`}\r\n          disabled={isUpdating}\r\n        >\r\n          {isUpdating ? \"Updating...\" : \"Update Template\"}\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditTemplateForm;\r\n"],"names":["EditTemplateForm","id","useParams","navigate","useNavigate","register","handleSubmit","reset","setValue","formState","errors","useForm","updateTemplate","isLoading","isUpdating","useUpdateTemplateMutation","data","template","isFetching","error","useGetTemplateByIdQuery","skip","categories","categoriesLoading","useGetEmailCategoriesQuery","useEffect","name","subject","body","category","_id","jsx","children","jsxs","message","className","onSubmit","async","unwrap","alert","htmlFor","required","value","map","emailCategory","placeholder","ReactQuill","onChange","type","disabled"],"mappings":"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"}