import{g as V,u as D,r as l,cs as O,ct as T,j as t,L as F,al as A,a as Q}from"./index-BBIQ2JaG-1746426193025.js";import{F as o}from"./index-B5p0oqBc-1746426193025.js";import{B as n}from"./Breadcrumb-BrOsfjN--1746426193025.js";import{R as k}from"./HomeOutlined-C6KZPR9K-1746426193025.js";import{S as L}from"./index-DRCoGNuy-1746426193025.js";import{U as S,R as P}from"./index-B-XNNwTK-1746426193025.js";import{B as d}from"./index-C2jQErNw-1746426193025.js";import{I as g}from"./index-CbABxJRi-1746426193025.js";import{s}from"./index-CkVR94Ui-1746426193025.js";import"./toArray-uRWhWYCg-1746426193025.js";import"./extends-rM07bN2b-1746426193025.js";import"./AntdIcon-D1dRJs5H-1746426193025.js";import"./index-4NCSjFKa-1746426193025.js";import"./CheckCircleFilled-KdwSm50E-1746426193025.js";import"./ExclamationCircleFilled-Cs3Fj5lZ-1746426193025.js";import"./dropdown-QB3XOUdc-1746426193025.js";import"./EllipsisOutlined-BV9z6e4b-1746426193025.js";import"./getAllowClear-D50Ut9zK-1746426193025.js";import"./CheckOutlined-CMmhl-tu-1746426193025.js";import"./Input-CbklOMj3-1746426193025.js";import"./fade-D-xjkMEp-1746426193025.js";import"./DeleteOutlined-R60uAL19-1746426193025.js";import"./DownloadOutlined-B6i-5kac-1746426193025.js";import"./EyeOutlined-BHXGT2Ti-1746426193025.js";import"./TextArea-Dcxjafrn-1746426193025.js";import"./InfoCircleFilled-uxDeatFe-1746426193025.js";const{Option:G}=L,fe=()=>{const{id:u}=V(),y=D(),[m]=o.useForm(),[p,B]=l.useState(!1),[c,w]=l.useState(!1),[C,E]=l.useState([]),{data:e,isLoading:b,refetch:U}=O(u),[q]=T();l.useEffect(()=>{(async()=>{try{const r=await Q.get("/api/menulist/get-menu");r.data.success&&E(r.data.data)}catch(r){console.error("Error fetching menu list:",r),s.error("Failed to fetch menu list")}})()},[]),l.useEffect(()=>{e&&m.setFieldsValue({title:e.title,altName:e.altName,details:e.details,imgName:e.imgName,pageSlug:e.pageSlug||"",image:e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[],photo:e.photo?[{name:e.photoName,url:`/api/photo/download/${e.photo}`}]:[]})},[e,m]);const $=a=>{B(!0),m.setFieldsValue({imgName:a.file.name,image:a.fileList})},M=a=>{w(!0),m.setFieldsValue({photo:a.fileList})},R=async a=>{var r,h,f,x,j,N,I;try{if(!((r=a.title)!=null&&r.trim())){s.error("Title is required");return}if(!((h=a.altName)!=null&&h.trim())){s.error("Alt Name is required");return}if(!a.pageSlug){s.error("Page Slug is required");return}const i=new FormData;p&&((x=(f=a.image)==null?void 0:f[0])!=null&&x.originFileObj)?(i.append("image",a.image[0].originFileObj),i.append("imgName",a.image[0].name)):i.append("imgName",a.imgName||e.imgName),c&&((N=(j=a.photo)==null?void 0:j[0])!=null&&N.originFileObj)?i.append("photo",a.photo[0].originFileObj):e.photo&&i.append("photo",e.photo),i.append("title",a.title.trim()),i.append("altName",a.altName.trim()),i.append("details",((I=a.details)==null?void 0:I.trim())||""),i.append("pageSlug",a.pageSlug),await q({id:u,bannerData:i}),s.success("Banner updated successfully"),U(),y("/banner-table")}catch(i){console.error(i),s.error("Failed to update banner")}};return b?t.jsx("div",{children:"Loading..."}):t.jsxs("div",{children:[t.jsxs(n,{style:{padding:"16px 24px"},children:[t.jsx(n.Item,{children:t.jsxs(F,{to:"/dashboard",children:[t.jsx(k,{})," Dashboard"]})}),t.jsx(n.Item,{children:t.jsx(F,{to:"/banner-table",children:"Banner Management"})}),t.jsx(n.Item,{children:"Edit Banner"})]}),t.jsxs("div",{style:{padding:"24px"},children:[t.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Edit Banner"}),t.jsxs(o,{form:m,layout:"vertical",onFinish:R,initialValues:{title:(e==null?void 0:e.title)||"",altName:(e==null?void 0:e.altName)||"",details:(e==null?void 0:e.details)||"",imgName:(e==null?void 0:e.imgName)||"",pageSlug:(e==null?void 0:e.pageSlug)||"",image:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[],photo:e!=null&&e.photo?[{name:e.photoName,url:`/api/image/download/${e.photo}`}]:[]},children:[t.jsx(o.Item,{name:"pageSlug",label:"Page Slug",rules:[{required:!0,message:"Please select a Page Slug!"}],children:t.jsx(L,{placeholder:"Select Page Slug",children:C.map(a=>t.jsx(G,{value:a.parent.path,children:a.parent.name},a._id))})}),t.jsx(o.Item,{name:"image",label:"Banner Image",valuePropName:"fileList",getValueFromEvent:a=>a&&a.fileList,children:t.jsx(S,{maxCount:1,listType:"picture",beforeUpload:()=>!1,onChange:$,defaultFileList:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[],children:t.jsx(d,{icon:t.jsx(P,{}),children:p?"Change Image":"Upload New Image"})})}),t.jsx(o.Item,{name:"photo",label:"Photo",valuePropName:"fileList",getValueFromEvent:a=>a&&a.fileList,children:t.jsx(S,{maxCount:1,listType:"picture",beforeUpload:()=>!1,onChange:M,defaultFileList:e!=null&&e.photo?[{name:e.photoName,url:`/api/photo/download/${e.photo}`}]:[],children:t.jsx(d,{icon:t.jsx(P,{}),children:c?"Change Photo":"Upload New Photo"})})}),t.jsx(o.Item,{name:"imgName",label:"Image Name",rules:[{required:!0,message:"Please input image name!"}],children:t.jsx(g,{disabled:p})}),t.jsx(o.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Please input title!"}],children:t.jsx(g,{})}),t.jsx(o.Item,{name:"altName",label:"Alt Name",rules:[{required:!0,message:"Please input alt name!"}],children:t.jsx(g,{})}),t.jsx(o.Item,{name:"details",label:"Details",rules:[{message:"Please input details!"}],children:t.jsx(A,{theme:"snow"})}),t.jsx(o.Item,{children:t.jsx(d,{type:"primary",htmlType:"submit",children:"Update"})})]})]})]})};export{fe as default};
