import{H as e,n as s,j as a,D as l,k as r,l as i,m as n,I as t,B as c,R as d,r as o,T as h,q as m,U as x,P as u}from"./main-DbCIA5nM.js";import{b as p,f as j,R as b,L as g}from"./vendor-X2E3PIZN.js";import{T as N,a as f,b as v,c as y,d as w,e as C}from"./table-DVNdpQ_I.js";import{A as S,a as k,b as L,c as D,d as _,e as A,f as I,g as P}from"./alert-dialog-DoWNvkno.js";import{B as O}from"./badge-uBIQGIZ4.js";import{D as T,a as F,b as $,c as z}from"./dropdown-menu-C0TLOZFq.js";import{E}from"./ellipsis-vertical-BYn5zANP.js";import{B as M}from"./BreadCrumb-BYTrRWt1.js";import"./utils-ZFgnvnbw.js";import"./index-BoWlxZtN.js";import"./chevron-right-BX1oQPFZ.js";import"./check-DSfnMMtB.js";const B=({open:d,onClose:o,chemicalName:h,supplier:m,supplierId:x,refetch:u,allData:j})=>{const[b,g]=p.useState(""),[N,f]=p.useState([]),{data:v,isLoading:y,error:w}=e(b,{skip:!b||b.length<2}),[C,{isLoading:S}]=s();return a.jsx(l,{open:d,onOpenChange:e=>!e&&o(),children:a.jsxs(r,{className:"max-w-lg p-6",children:[a.jsx(i,{children:a.jsxs(n,{className:"text-lg font-semibold text-[#3b1f91]",children:["Add Chemicals for ",m]})}),a.jsxs("div",{className:"mt-4",children:[a.jsx(t,{placeholder:`Search ${m}`,value:b,onChange:e=>g(e.target.value),className:"w-full mb-4"}),y?a.jsx("div",{children:"Loading..."}):b&&v&&v.length>0&&a.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:v.map((e=>a.jsx("li",{onClick:()=>(e=>{f((s=>{const a=[...s,e];return g(""),a}))})(e),className:"p-2 hover:bg-gray-200 cursor-pointer",children:e.name},e._id)))}),0===v?.length&&!y&&b&&a.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),a.jsx("div",{className:"mt-4",children:N.length>0&&a.jsx("div",{className:"space-y-2",children:N.map((e=>a.jsxs("div",{className:"flex justify-between items-center bg-gray-100 p-2 rounded",children:[a.jsx("span",{children:e.name}),a.jsx(c,{variant:"outline",size:"sm",onClick:()=>{return s=e._id,void f((e=>e.filter((e=>e._id!==s))));var s},className:"text-red-500",children:"Remove"})]},e._id)))})}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsx(c,{onClick:async()=>{const e=N.map((e=>e._id));try{await C({supplierId:x,chemical_ids:e}).unwrap(),await u(),o(),j()}catch(s){}},className:"bg-[#3b1f91] hover:bg-purple-700",disabled:S||0===N.length,children:S?"Adding...":"+ Add"}),a.jsx(c,{onClick:o,className:"bg-red-600 hover:bg-red-700",children:"Cancel"})]})]})]})})};function R({supplier:e,supplierName:s,allData:l}){const[r,t]=p.useState(10),[m,x]=p.useState(1),[u,j]=p.useState(1),[b,g]=p.useState(!1),[O,T]=p.useState(null),[F,$]=p.useState(null),[z,E]=p.useState(!1),[M,R]=p.useState(null),{data:H,isLoading:q,isError:G,refetch:U}=d(e,{skip:(m-1)*r,limit:r}),[V,{isLoading:W}]=o();p.useEffect((()=>{H&&j(Math.ceil(H.chemicals.length/r))}),[H,r]);if(q)return a.jsx("div",{children:"Loading..."});if(G)return a.jsx("div",{children:"Error loading chemicals"});const X=Array.isArray(H?.chemicals)?H.chemicals:[];return a.jsxs("div",{className:"w-full overflow-auto",children:[a.jsx(i,{children:a.jsxs("div",{className:"flex justify-between items-center mr-5",children:[a.jsxs(n,{children:["Chemicals for ",s]}),a.jsx(c,{onClick:()=>(T(X),g(!0),void $("supplier")),className:"bg-purple-600 hover:bg-purple-700",children:"+ Add Chemical"})]})}),a.jsx("div",{className:"mt-5 ",children:a.jsxs(N,{children:[a.jsx(f,{children:a.jsxs(v,{children:[a.jsx(y,{className:"p-2",children:"Name"}),a.jsx(y,{className:"p-2",children:"CAS Number"}),a.jsx(y,{className:"p-2 w-[100px]",children:"Action"})]})}),a.jsx(w,{children:X.map(((e,s)=>a.jsxs(v,{className:"p-2",children:[a.jsx(C,{className:"px-2 py-1",children:e.name}),a.jsx(C,{className:"px-2 py-1",children:e.cas_number}),a.jsx(C,{className:"px-2 py-1",children:a.jsx(c,{variant:"ghost",size:"icon",className:"text-red-500",onClick:()=>(e=>{R(e),E(!0)})(e),disabled:W,children:W?"Deleting...":a.jsx(h,{className:"h-4 w-4"})})})]},s)))})]})}),b&&O&&a.jsx(B,{open:b,onClose:()=>g(!1),chemicalName:O.name,supplier:s,supplierId:e,refetch:U,allData:l}),a.jsx(S,{open:z,onOpenChange:E,children:a.jsxs(k,{children:[a.jsxs(L,{children:[a.jsx(D,{children:"Are you sure?"}),a.jsxs(_,{children:["This action cannot be undone. This will permanently delete the chemical",M&&` "${M.name}"`," from this supplier."]})]}),a.jsxs(A,{children:[a.jsx(I,{children:"Cancel"}),a.jsx(P,{onClick:async()=>{try{await V({supplierId:e,chemicalId:M._id}).unwrap(),U()}catch(s){}finally{E(!1),R(null)}},className:"bg-red-500 hover:bg-red-600",children:"Delete"})]})]})}),a.jsxs("div",{className:"flex items-center justify-between mt-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm",children:"Items per page:"}),a.jsxs("select",{className:"border p-1 rounded",value:r,onChange:e=>t(Number(e.target.value)),children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:20,children:"20"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(c,{variant:"outline",size:"sm",onClick:()=>{m>1&&x(m-1)},disabled:1===m,children:"Previous"}),a.jsxs("span",{children:[m," of ",u]}),a.jsx(c,{variant:"outline",size:"sm",onClick:()=>{m<u&&x(m+1)},disabled:m===u,children:"Next"})]})]})]})}const H=()=>{const{data:e=[],isLoading:s,error:i}=m(),[n,t]=p.useState(1),[d,o]=p.useState(10),[h,u]=p.useState(!1),[g,S]=p.useState(null),[k,L]=p.useState({name:"",email:"",mobile:"",country:"",website:""}),D=j(),[_,A]=p.useState(null),[I,P]=p.useState(!1),{refetch:M}=m(),[H]=x(),q=(e,s)=>{L((a=>({...a,[e]:s}))),t(1)},G=e.filter((e=>{const s=k.name.toLowerCase();return(!k.name||e.name.toLowerCase().includes(s)||e.email.toLowerCase().includes(s)||e.mobile.toLowerCase().includes(s))&&(!k.country||e.country.toLowerCase().includes(k.country.toLowerCase()))&&(!k.website||e.website.toLowerCase().includes(k.website.toLowerCase()))})),U=Math.ceil(G.length/d),V=G.slice((n-1)*d,n*d);return s?a.jsx("div",{children:"Loading..."}):i?a.jsxs("div",{children:["Error loading suppliers: ",i.message]}):a.jsxs("div",{children:[a.jsx("div",{className:"rounded-md shadow-sm bg-white",children:a.jsxs(N,{className:"w-full text-left border-collapse",children:[a.jsxs(f,{className:"bg-gray-100 border-b border-gray-300",children:[a.jsxs(v,{className:"text-gray-600 font-semibold",children:[a.jsx(y,{className:"w-10"}),a.jsx(y,{children:"Info"}),a.jsx(y,{children:"Chemicals"}),a.jsx(y,{children:"Country"}),a.jsx(y,{children:"Website"})]}),a.jsxs(v,{className:"bg-gray-50",children:[a.jsx(C,{}),a.jsx(C,{children:a.jsx("input",{type:"text",placeholder:"Filter by name, email or mobile",className:"p-2 rounded w-full border border-gray-300",value:k.name,onChange:e=>q("name",e.target.value)})}),a.jsx(C,{}),a.jsx(C,{children:a.jsx("input",{type:"text",placeholder:"Filter by country",className:"p-2 rounded w-full border border-gray-300",value:k.country,onChange:e=>q("country",e.target.value)})}),a.jsx(C,{children:a.jsx("input",{type:"text",placeholder:"Filter by website",className:"p-2 rounded w-full border border-gray-300",value:k.website,onChange:e=>q("website",e.target.value)})})]})]}),a.jsx(w,{children:V.map((e=>a.jsx(b.Fragment,{children:a.jsxs(v,{className:"hover:bg-gray-50 border-b border-gray-300",children:[a.jsx(C,{className:"p-2",children:a.jsxs(T,{children:[a.jsx(F,{asChild:!0,children:a.jsx("button",{className:"p-3",children:a.jsx(E,{className:"w-4 h-4"})})}),a.jsxs($,{align:"end",children:[a.jsx(z,{onClick:()=>(e=>{S(e),u(!0)})(e),children:"Add Chemical"}),a.jsx(z,{onClick:()=>D(`/edit-supplier-form/${e._id}`),children:"Edit"}),a.jsx(z,{onClick:()=>(async e=>{try{await H(e)}catch(s){}})(e._id),children:"Delete"})]})]})}),a.jsx(C,{children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-medium",children:e.name}),a.jsx("span",{className:"text-sm text-gray-600",children:e.email}),a.jsx("span",{className:"text-sm text-gray-600",children:e.mobile})]})}),a.jsx(C,{children:a.jsxs(c,{variant:"default",size:"sm",onClick:()=>(e=>{A(e),P(!0)})(e),className:"bg-[#3b1f91] text-white px-4 py-2 rounded hover:bg-[#3b1f91] transition-colors duration-300",children:["Chemicals",a.jsx(O,{variant:"secondary",className:"ml-2 bg-gray-200 text-black px-2 py-1 rounded",children:e.totalChemicalIds||0})]})}),a.jsx(C,{children:e.country}),a.jsx(C,{children:a.jsx(Link,{to:e.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:e.website})})]})},e._id)))})]})}),a.jsxs("div",{className:"flex justify-between items-center mt-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"items-per-page",className:"mr-2",children:"Items per page:"}),a.jsxs("select",{id:"items-per-page",className:"p-2  border border-gray-300 rounded",value:d,onChange:e=>{o(parseInt(e.target.value)),t(1)},children:[a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:20,children:"20"}),a.jsx("option",{value:30,children:"30"}),a.jsx("option",{value:40,children:"40"}),a.jsx("option",{value:50,children:"50"})]})]}),a.jsxs("div",{children:[a.jsx("button",{onClick:()=>t((e=>Math.max(e-1,1))),className:"px-3 py-1 border border-gray-300 rounded mr-2",disabled:1===n,children:"Previous"}),a.jsxs("span",{children:["Page ",n," of ",U]}),a.jsx("button",{onClick:()=>t((e=>Math.min(e+1,U))),className:"px-3 py-1 border border-gray-300 rounded ml-2",disabled:n===U,children:"Next"})]})]}),h&&a.jsx(B,{open:h,onClose:()=>u(!1),supplier:g,supplierId:g?._id,chemicalName:g?.name}),a.jsx(l,{open:I,onOpenChange:P,children:a.jsx(r,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:I&&_&&a.jsx(R,{supplier:_._id,supplierName:_.name,allData:M})})})]})},q=({purchaseOrders:e})=>a.jsxs(N,{children:[a.jsx(f,{children:a.jsxs(v,{children:[a.jsx(y,{children:"Created Date"}),a.jsx(y,{children:"Order Number"}),a.jsx(y,{children:"Payment Status"}),a.jsx(y,{children:"Total Tax"}),a.jsx(y,{children:"Total Discount"}),a.jsx(y,{children:"Total Amount"})]})}),a.jsx(w,{children:e.map(((e,s)=>a.jsxs(v,{children:[a.jsx(C,{children:e.createdDate}),a.jsx(C,{children:e.orderNumber}),a.jsx(C,{children:e.paymentStatus}),a.jsxs(C,{children:["$",e.totalTax]}),a.jsxs(C,{children:["$",e.totalDiscount]}),a.jsxs(C,{children:["$",e.totalAmount]})]},s)))})]}),G=[{label:"Dashboard",href:"/dashboard"},{label:"Supplier Table",href:null}];function U(){const[e,s]=p.useState({}),[i,n]=p.useState(!1),[t,d]=p.useState(null),[o,h]=p.useState(1),[x,j]=p.useState(5),{data:b=[],isLoading:N,error:f,refetch:v}=m(),[y,w]=p.useState({});if(N)return a.jsx("p",{children:"Loading suppliers..."});if(f)return a.jsx("p",{children:"Failed to load suppliers"});return a.jsxs("div",{className:"",children:[a.jsx(M,{items:G}),a.jsxs("div",{className:"flex justify-between mt-4 items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-medium text-[#3b1f91] ",children:"Suppliers"}),a.jsx(g,{to:"/supplier-form",children:a.jsxs(c,{children:[a.jsx(u,{className:"w-4 h-4 mr-2"}),"Add Supplier"]})})]}),a.jsx(H,{suppliers:b,showPurchaseOrders:e,setShowPurchaseOrders:s,setSelectedSupplier:d,setShowChemicalsModal:n,filters:y,handleFilterChange:(e,s)=>{w((a=>({...a,[e]:s})))},currentPage:o,itemsPerPage:x,paginatedData:b.slice((o-1)*x,o*x),selectedSupplier:t,refetch:v,onChemicalClick:e=>{d(e),n(!0)}}),e[t?.id]&&t&&a.jsxs("div",{className:"mt-6",children:[a.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Purchase Orders for ",t.name]}),a.jsx(q,{purchaseOrders:[]}),"  "]}),a.jsx(l,{open:i,onOpenChange:e=>{n(e)},children:a.jsx(r,{className:"max-w-2xl h-1/2",children:a.jsx(R,{supplier:t?._id,supplierName:t?.name,allData:v})})})]})}export{U as default};
//# sourceMappingURL=SupplierTablePage-ZgUnKc7J.js.map
