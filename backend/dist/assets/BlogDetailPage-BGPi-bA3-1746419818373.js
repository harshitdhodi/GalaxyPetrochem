import{c as N,g as w,cf as b,cg as P,r as c,j as e,k as B,L as h,a as g,u as I,P as d}from"./index-CyqvOuOg-1746419818373.js";import{E as L}from"./eye-BSYxHLbt-1746419818373.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=N("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),p=({title:i,image:s,date:o,slug:n,visits:l})=>{const m=I(),r=()=>{m(`/blog/${n}`)};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md shadow-[#995f99] overflow-hidden mb-4 group relative cursor-pointer",onClick:r,children:[e.jsxs("div",{className:"overflow-hidden relative",children:[e.jsx("img",{src:`/api/image/download/${s==null?void 0:s[0]}`,alt:i,name:i,className:"w-full h-40 object-cover transform transition-transform duration-300 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-primary/40 bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold hover:border-b text-lg mb-2 group relative",children:i}),e.jsxs("div",{className:"flex items-center justify-between text-gray-600 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("p",{children:o})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("p",{children:l})]})]})]})]})};p.propTypes={title:d.string.isRequired,image:d.string.isRequired,date:d.string.isRequired,slug:d.string.isRequired};const E=()=>{const{slug:i}=w(),{data:s,error:o,isLoading:n}=b(i),{data:l=[],isLoading:m}=P(i),[r,j]=c.useState([]),[R,f]=c.useState(!0),v=location.pathname.replace(/^\//,"")||"introduction";return c.useEffect(()=>{(async()=>{try{const t=await g.get("/api/banner/getByPageSlug?pageSlug=blogs");console.log(t.data),j(t.data||[])}catch(t){console.error("Failed to fetch banner:",t)}finally{f(!1)}})()},[v]),c.useEffect(()=>{(async()=>{var t;if(n||!(s!=null&&s._id)){console.log("Skipping API call: isLoading=",n,"blog._id=",s==null?void 0:s._id);return}try{console.log("Fetching IP...");const u=(await g.get("https://api.ipify.org?format=json")).data.ip;console.log("Client IP:",u),console.log("Calling incrementBlogVisits API...");const y=await g.put(`/api/blog/incrementBlogVisits?id=${s._id}&clientIP=${u}`);console.log("API call successful:",y.data)}catch(x){console.error("Failed to get IP or increment visit:",((t=x.response)==null?void 0:t.data)||x.message)}})()},[s,n]),n?e.jsx("div",{children:"Loading blog..."}):o?e.jsx("div",{children:"Something went wrong..."}):m?e.jsx("div",{children:"Loading recent posts..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[r&&r.length>0?e.jsx(B,{imageUrl:`/api/image/download/${r[0].image}`,title:r[0].title}):"no banner",e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 mt-5 z-10",children:e.jsxs("nav",{className:" px-4 py-2 rounded-md text-white text-sm sm:text-md font-semibold",children:[e.jsx(h,{to:"/",children:e.jsx("span",{className:"    text-[12px] sm:text-[15px]",children:"Home"})}),e.jsx("span",{className:"mx-2",children:"/"}),e.jsx(h,{to:"/blogs",children:e.jsx("span",{className:" text-[12px] sm:text-[15px]",children:"Blogs"})}),e.jsx("span",{className:"mx-2",children:"/"}),e.jsx(h,{to:`/blog/${i}`,children:e.jsx("span",{className:" text-[12px] sm:text-[15px]",children:s==null?void 0:s.title})})]})})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-8",children:e.jsxs("div",{className:"flex flex-wrap gap-5",children:[e.jsxs("div",{className:"w-full lg:w-[65%] px-4 mb-8 lg:mb-0",children:[e.jsx("h1",{className:"text-4xl text-[#2d60d6] font-bold mb-4",children:s==null?void 0:s.title}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Published on ",s==null?void 0:s.date," | By ",s==null?void 0:s.postedBy]}),e.jsx("img",{src:`/api/image/download/${s==null?void 0:s.image}`,alt:s==null?void 0:s.title,className:"w-full h-[400px] object-cover rounded-lg mb-6"}),e.jsx("div",{className:"prose max-w-none",children:e.jsx("div",{className:"text-gray-600 text-lg text-justify mb-4",dangerouslySetInnerHTML:{__html:s==null?void 0:s.details}})})]}),e.jsxs("div",{className:"w-full lg:w-[30%] h-fit shadow-md shadow-[#2d60d6]/70 ml-8 py-5 rounded-md px-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-blue-900",children:"Recent Posts"}),l==null?void 0:l.map((a,t)=>e.jsx(p,{title:a==null?void 0:a.title,image:a==null?void 0:a.image,date:a==null?void 0:a.date,slug:a==null?void 0:a.slug,visits:a==null?void 0:a.visits},t))]})]})})]})};export{E as B};
