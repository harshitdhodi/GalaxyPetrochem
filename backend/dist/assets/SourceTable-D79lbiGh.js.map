{"version":3,"file":"SourceTable-D79lbiGh.js","sources":["../../src/inquiry/source/AddSource.jsx","../../src/inquiry/source/SourceTable.jsx"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport { useForm } from 'react-hook-form';\r\nimport { useCreateSourceMutation, useGetSourceByIdQuery, useUpdateSourceMutation } from '@/slice/source/source';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogDescription,\r\n  DialogClose,\r\n} from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\n\r\nexport const SourceForm = ({ closeModal, sourceToEdit = null }) => {\r\n  const { register, handleSubmit, reset } = useForm({\r\n    defaultValues: sourceToEdit ? {\r\n      name: sourceToEdit.source // Adjust this based on your actual source object structure\r\n    } : {}\r\n  });\r\n\r\n  const [createSource, { isLoading: isCreating, isSuccess: isCreateSuccess, isError: isCreateError }] = useCreateSourceMutation();\r\n  const [updateSource, { isLoading: isUpdating, isSuccess: isUpdateSuccess, isError: isUpdateError }] = useUpdateSourceMutation(sourceToEdit?._id);\r\n\r\n  const { data: sourceData, isLoading: isLoadingSource } = useGetSourceByIdQuery(sourceToEdit?._id, {\r\n    skip: !sourceToEdit?._id, // Don't fetch if no sourceToEdit is passed\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (sourceData) {\r\n      reset({ source: sourceData.data.source }); // Reset the form with the fetched source data\r\n    }\r\n  }, [sourceData, reset]);\r\n\r\n  const onSubmit = async (data) => {\r\n    try {\r\n      if (sourceToEdit) {\r\n        // Handle update logic if editing\r\n        await updateSource({ id: sourceToEdit._id, ...data }).unwrap();\r\n      } else {\r\n        // Handle create logic\r\n        await createSource(data).unwrap();\r\n      }\r\n      reset();\r\n      closeModal();\r\n      alert(sourceToEdit ? 'Source updated successfully!' : 'Source created successfully!');\r\n    } catch (error) {\r\n      alert(sourceToEdit ? 'Failed to update source.' : 'Failed to create source.');\r\n    }\r\n  };\r\n\r\n  if (isLoadingSource) {\r\n    return <p>Loading source data...</p>;\r\n  }\r\n\r\n  return (\r\n    <DialogContent>\r\n      <DialogHeader>\r\n        <DialogTitle>{sourceToEdit ? 'Edit Source' : 'Add Source'}</DialogTitle>\r\n        <DialogDescription>\r\n          {sourceToEdit ? 'Update the existing source.' : 'Fill out the form below to add a new source.'}\r\n        </DialogDescription>\r\n      </DialogHeader>\r\n\r\n      <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-4 p-4\">\r\n        <div>\r\n          <label htmlFor=\"name\" className=\"block text-sm font-medium\">\r\n            Name\r\n          </label>\r\n          <input\r\n            id=\"name\"\r\n            {...register('source', { required: 'Name is required' })}\r\n            className=\"w-full px-4 py-2 border rounded\"\r\n            placeholder=\"Enter source name\"\r\n          />\r\n        </div>\r\n\r\n        <Button\r\n          type=\"submit\"\r\n          className=\"w-full bg-blue-500 text-white rounded hover:bg-blue-600\"\r\n          disabled={isCreating || isUpdating}\r\n        >\r\n          {isCreating || isUpdating ? 'Submitting...' : (sourceToEdit ? 'Update' : 'Submit')}\r\n        </Button>\r\n\r\n        {isCreateSuccess && !sourceToEdit && <p className=\"text-green-500\">Source added successfully!</p>}\r\n        {isUpdateSuccess && sourceToEdit && <p className=\"text-green-500\">Source updated successfully!</p>}\r\n        {(isCreateError || isUpdateError) && (\r\n          <p className=\"text-red-500\">\r\n            Error {sourceToEdit ? 'updating' : 'adding'} source.\r\n          </p>\r\n        )}\r\n      </form>\r\n\r\n      <DialogClose />\r\n    </DialogContent>\r\n  );\r\n};\r\n","import { Button } from '@/components/ui/button';\r\nimport { Dialog, DialogTrigger } from '@/components/ui/dialog';\r\nimport { useGetAllSourcesQuery, useDeleteSourceMutation, useUpdateSourceMutation } from '@/slice/source/source';\r\nimport { Plus, Edit, Trash } from 'lucide-react'; // Importing the Edit and Trash icons from lucide-react\r\nimport React, { useState } from 'react';\r\nimport { SourceForm } from './AddSource';\r\n\r\nexport const SourceTable = () => {\r\n  const { data: sourcesResponse, isLoading, isError } = useGetAllSourcesQuery();\r\n  const [deleteSource] = useDeleteSourceMutation();\r\n  const [updateSource] = useUpdateSourceMutation();\r\n  const [sourceToEdit, setSourceToEdit] = useState(null);\r\n  const [isEditModalOpen, setIsEditModalOpen] = useState(false); // New state to control edit modal\r\n  const sources = sourcesResponse?.data;\r\n\r\n  const handleDelete = async (id) => {\r\n    try {\r\n      await deleteSource(id).unwrap();\r\n      alert('Source deleted successfully!');\r\n    } catch (error) {\r\n      alert('Failed to delete source.');\r\n    }\r\n  };\r\n\r\n  const handleEdit = (source) => {\r\n    setSourceToEdit(source);\r\n    setIsEditModalOpen(true); // Open the edit modal\r\n  };\r\n\r\n  const handleCloseModal = () => {\r\n    setSourceToEdit(null);\r\n    setIsEditModalOpen(false); // Close the edit modal\r\n  };\r\n\r\n  if (isLoading) return <div>Loading...</div>;\r\n  if (isError) return <div>Error fetching sources.</div>;\r\n\r\n  return (\r\n    <div className=\"overflow-x-auto\">\r\n      <div className=\"flex justify-between items-center mb-4\">\r\n        <h1 className=\"text-xl font-semibold\">Source List</h1>\r\n        <Dialog>\r\n          <DialogTrigger asChild>\r\n            <Button className=\"gap-2\">\r\n              <Plus className=\"h-4 w-4\" />\r\n              Add Source\r\n            </Button>\r\n          </DialogTrigger>\r\n          <SourceForm closeModal={handleCloseModal} />\r\n        </Dialog>\r\n      </div>\r\n\r\n      <table className=\"table-auto border-collapse border border-gray-300 w-1/3 text-left\">\r\n        <thead>\r\n          <tr>\r\n            <th className=\"border border-gray-300 px-4 py-2\">Name</th>\r\n            <th className=\"border border-gray-300 px-4 py-2\">Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {sources?.map((source) => (\r\n            <tr key={source._id}>\r\n              <td className=\"border border-gray-300 px-4 py-2\">{source.source}</td>\r\n              <td className=\"border border-gray-300 px-4 py-2\">\r\n                <Edit\r\n                  className=\"inline-block mx-2 cursor-pointer text-blue-500\"\r\n                  title=\"Edit\"\r\n                  onClick={() => handleEdit(source)}\r\n                />\r\n                <Trash\r\n                  className=\"inline-block mx-2 cursor-pointer text-red-500\"\r\n                  title=\"Delete\"\r\n                  onClick={() => handleDelete(source._id)}\r\n                />\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n\r\n      {/* Edit Modal - now controlled by isEditModalOpen */}\r\n      <Dialog open={isEditModalOpen} onOpenChange={handleCloseModal}>\r\n        <SourceForm \r\n          closeModal={handleCloseModal} \r\n          sourceToEdit={sourceToEdit} \r\n        />\r\n      </Dialog>\r\n    </div>\r\n  );\r\n};"],"names":["SourceForm","closeModal","sourceToEdit","register","handleSubmit","reset","useForm","defaultValues","name","source","createSource","isLoading","isCreating","isSuccess","isCreateSuccess","isError","isCreateError","useCreateSourceMutation","updateSource","isUpdating","isUpdateSuccess","isUpdateError","useUpdateSourceMutation","_id","data","sourceData","isLoadingSource","useGetSourceByIdQuery","skip","useEffect","jsx","children","DialogContent","jsxs","DialogHeader","DialogTitle","DialogDescription","onSubmit","async","id","unwrap","alert","error","className","htmlFor","required","placeholder","Button","type","disabled","DialogClose","SourceTable","sourcesResponse","useGetAllSourcesQuery","deleteSource","useDeleteSourceMutation","setSourceToEdit","useState","isEditModalOpen","setIsEditModalOpen","sources","handleCloseModal","Dialog","DialogTrigger","asChild","Plus","map","Edit","title","onClick","handleEdit","Trash","handleDelete","open","onOpenChange"],"mappings":"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"}