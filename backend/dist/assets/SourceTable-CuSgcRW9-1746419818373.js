import{bZ as w,b_ as f,b$ as D,r as p,j as e,ai as C,aj as L,ak as M,c0 as k,B as y,c1 as v,by as F,c2 as _,ag as g,ah as U,ay as A}from"./index-CyqvOuOg-1746419818373.js";import{u as q}from"./index.esm-C6wQHXy3-1746419818373.js";import{P as B}from"./plus-DdXIh4JK-1746419818373.js";import{T as O}from"./trash-C9Mkm7ub-1746419818373.js";const S=({closeModal:r,sourceToEdit:s=null})=>{const{register:o,handleSubmit:u,reset:i}=q({defaultValues:s?{name:s.source}:{}}),[x,{isLoading:t,isSuccess:m,isError:n}]=w(),[l,{isLoading:d,isSuccess:h,isError:c}]=f(s==null?void 0:s._id),{data:a,isLoading:j}=D(s==null?void 0:s._id,{skip:!(s!=null&&s._id)});p.useEffect(()=>{a&&i({source:a.data.source})},[a,i]);const N=async b=>{try{s?await l({id:s._id,...b}).unwrap():await x(b).unwrap(),i(),r(),alert(s?"Source updated successfully!":"Source created successfully!")}catch{alert(s?"Failed to update source.":"Failed to create source.")}};return j?e.jsx("p",{children:"Loading source data..."}):e.jsxs(C,{children:[e.jsxs(L,{children:[e.jsx(M,{children:s?"Edit Source":"Add Source"}),e.jsx(k,{children:s?"Update the existing source.":"Fill out the form below to add a new source."})]}),e.jsxs("form",{onSubmit:u(N),className:"space-y-4 p-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium",children:"Name"}),e.jsx("input",{id:"name",...o("source",{required:"Name is required"}),className:"w-full px-4 py-2 border rounded",placeholder:"Enter source name"})]}),e.jsx(y,{type:"submit",className:"w-full bg-blue-500 text-white rounded hover:bg-blue-600",disabled:t||d,children:t||d?"Submitting...":s?"Update":"Submit"}),m&&!s&&e.jsx("p",{className:"text-green-500",children:"Source added successfully!"}),h&&s&&e.jsx("p",{className:"text-green-500",children:"Source updated successfully!"}),(n||c)&&e.jsxs("p",{className:"text-red-500",children:["Error ",s?"updating":"adding"," source."]})]}),e.jsx(v,{})]})},V=()=>{const{data:r,isLoading:s,isError:o}=F(),[u]=_(),[i]=f(),[x,t]=p.useState(null),[m,n]=p.useState(!1),l=r==null?void 0:r.data,d=async a=>{try{await u(a).unwrap(),alert("Source deleted successfully!")}catch{alert("Failed to delete source.")}},h=a=>{t(a),n(!0)},c=()=>{t(null),n(!1)};return s?e.jsx("div",{children:"Loading..."}):o?e.jsx("div",{children:"Error fetching sources."}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-xl font-semibold",children:"Source List"}),e.jsxs(g,{children:[e.jsx(U,{asChild:!0,children:e.jsxs(y,{className:"gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"Add Source"]})}),e.jsx(S,{closeModal:c})]})]}),e.jsxs("table",{className:"table-auto border-collapse border border-gray-300 w-1/3 text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Name"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Actions"})]})}),e.jsx("tbody",{children:l==null?void 0:l.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:a.source}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2",children:[e.jsx(A,{className:"inline-block mx-2 cursor-pointer text-blue-500",title:"Edit",onClick:()=>h(a)}),e.jsx(O,{className:"inline-block mx-2 cursor-pointer text-red-500",title:"Delete",onClick:()=>d(a._id)})]})]},a._id))})]}),e.jsx(g,{open:m,onOpenChange:c,children:e.jsx(S,{closeModal:c,sourceToEdit:x})})]})};export{V as SourceTable};
