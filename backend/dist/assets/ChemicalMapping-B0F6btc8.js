import{j as e,H as s,o as a,I as t,B as l,af as i,ac as r,v as c}from"./main-DbCIA5nM.js";import{b as o,R as n}from"./vendor-X2E3PIZN.js";import{F as d}from"./Table-DuH0XXff.js";import{S as m}from"./index-TlfG7RwS.js";import{S as h}from"./index-DKxChPud.js";import{B as u}from"./index-CvhnQ2ZS.js";import{B as p}from"./react-toastify.esm-DdEtEw-Q.js";import{B as j}from"./BreadCrumb-BYTrRWt1.js";import"./utils-ZFgnvnbw.js";import"./objectSpread2-C2mPdFQ-.js";import"./AntdIcon-Bc_RgQsY.js";import"./addEventListener-Dm19rJS7.js";import"./toArray-DIarnBRF.js";import"./dropdown-C2Lyn6ws.js";import"./index-Cie-PtDs.js";import"./getAllowClear-CF0z5FWe.js";import"./index-CoLLPh3Y.js";import"./Input-DzV7KJ8a.js";import"./CheckOutlined-qoM0f-f3.js";import"./chevron-right-BX1oQPFZ.js";function x({chemicals:s,onRemoveChemical:a}){const[t,l]=o.useState(1),[i,r]=o.useState(10),c=Math.ceil((s?.length||0)/i),n=(t-1)*i,p=n+i,j=s?.slice(n,p),x=[{title:"Action",dataIndex:"action",render:(s,t)=>e.jsx(u,{type:"primary",danger:!0,size:"small",onClick:()=>a(t),children:"Delete"})},{title:"Chemical Name",dataIndex:"name"},{title:"CAS Number",dataIndex:"cas_number"}];return e.jsxs("div",{className:"border rounded-md mt-4 p-4",children:[e.jsx(d,{columns:x,dataSource:j,rowKey:"_id",pagination:!1}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Items per page:"," ",e.jsx(m,{value:i,onChange:e=>{r(e),l(1)},options:[{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"}],style:{width:80}})]}),e.jsxs(h,{children:[e.jsx(u,{type:"default",size:"small",onClick:()=>l(t-1),disabled:1===t,children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[n+1," - ",Math.min(p,s?.length||0)," of"," ",s?.length||0]}),e.jsx(u,{type:"default",size:"small",onClick:()=>l(t+1),disabled:t===c,children:"Next"})]})]})]})}function g({selectedCustomer:i,refetchCustomer:r}){const[c,n]=o.useState(""),[d,m]=o.useState(""),[h,u]=o.useState(null),{data:j,isLoading:x}=s(d.charAt(0),{skip:0===d.length}),[g,{isLoading:b}]=a();return e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(t,{placeholder:"Search Chemical",value:c,onChange:e=>{const s=e.target.value;n(s),m(s)},className:"w-full mb-4",disabled:!i}),x&&e.jsx("div",{className:"absolute top-2 right-4 text-sm text-gray-500",children:"Loading..."})]}),d&&j?.length>0&&e.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:j.map((s=>e.jsx("li",{onClick:()=>(e=>{u(e),n(e.name),m("")})(s),className:"p-2 hover:bg-gray-200 cursor-pointer",children:s.name},s._id)))}),e.jsx(l,{onClick:async()=>{if(h&&i)try{const e=h.id||h._id,s=i._id;await g({customerId:s,chemicalId:e}).unwrap(),n(""),u(null),await r(),p.success("Chemical added successfully")}catch(e){p.error(e.message||"Failed to add chemical")}else p.error("Please select both customer and chemical")},disabled:b||!h||!i,className:"mt-4 w-[10%] py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:b?"Adding...":"Add "})]})}function b({onSelectCustomer:s}){const[a,l]=o.useState(""),[n,d]=o.useState(""),[m,h]=o.useState(null),{data:u,isLoading:j,refetch:b}=i(n.charAt(0),{skip:0===n.length}),{data:f,refetch:v}=r(m?._id,{skip:!m?._id}),[C]=c(),y=f?.data||m;return e.jsxs("div",{className:"mt-4",children:[e.jsx(t,{placeholder:"Search Customer",value:a,onChange:e=>{const s=e.target.value;l(s),d(s)},className:"w-full mb-4"}),j?e.jsx("div",{children:"Loading..."}):n&&u&&u.length>0&&e.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:u.map((a=>e.jsx("li",{onClick:()=>(e=>{h(e),l(e.name),d(""),s(e)})(a),className:"p-2 hover:bg-gray-200 cursor-pointer",children:a.name},a._id)))}),e.jsx(g,{selectedCustomer:y,refetchCustomer:async()=>{await Promise.all([v(),b()])}}),y&&e.jsx(x,{chemicals:y.chemicalId||[],onRemoveChemical:async e=>{try{await C({customerId:m._id,chemicalId:e._id}).unwrap(),await Promise.all([v(),b()]),p.success("Chemical removed successfully")}catch(s){p.error("Failed to remove chemical")}}})]})}const f=[{label:"Dashboard",href:"/dashboard"},{label:"Chemical Mapping",href:null}];function v(){const[s,a]=n.useState(null),[t,l]=n.useState([]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"ml-1",children:e.jsx(j,{items:f})}),e.jsxs("div",{className:"py-4 space-y-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-purple-700",children:"Assign Chemicals to Customer"}),e.jsx("div",{className:"space-y-4",children:e.jsx(b,{onSelectCustomer:e=>{a(e),l([])}})})]})]})}export{v as default};
//# sourceMappingURL=ChemicalMapping-B0F6btc8.js.map
