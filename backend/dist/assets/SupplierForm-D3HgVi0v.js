import{as as e,j as s,C as r,b6 as a,b7 as l,aD as n,I as t,B as c,X as i}from"./main-CYgOQvaw.js";import{f as o,b as d}from"./vendor-BCMiqwDy.js";import{b as m}from"./index.esm-nvYjwl0o.js";import{F as j,a as x,b as h,c as p,d as u,e as f}from"./form-DIbFRgGb.js";import{T as b}from"./textarea-BQffPqX4.js";import{B as g}from"./BreadCrumb-CCpOg2-Q.js";import{S as y}from"./sweetalert2.esm.all-D2QuJ--x.js";import{S as N,a as w,b as S,c as v,d as C}from"./select-C9JtKdjQ.js";import"./utils-ZFgnvnbw.js";import"./chevron-right-BHJrePhs.js";import"./index-D3SX27xu.js";import"./index-prcspqn7.js";import"./check-BmKpgWX1.js";import"./chevron-up-LTThVSTS.js";const E=[{label:"Dashboard",href:"/dashboard"},{label:"Supplier Table",href:"/supplier-table"},{label:"Supplier Form",href:"/supplier-form"}];function F(){const F=o(),[A,B]=d.useState(!1),[I,P]=d.useState(null),[U,V]=d.useState(null),{refetch:k}=e(),D=m({defaultValues:{supplierName:"",contactPerson:"",email:"",website:"",mobileNumber:"",phoneNumber:"",address:"",country:"",city:"",description:"",image:null}}),[O,R]=d.useState([]),[T,_]=d.useState([]);d.useEffect((()=>{fetch("https://restcountries.com/v3.1/all").then((e=>e.json())).then((e=>{const s=e.map((e=>({name:e.name.common,code:e.cca2}))).sort(((e,s)=>e.name.localeCompare(s.name)));R(s)})).catch((e=>{}))}),[]);const L=e=>{const s=e.target.files[0];s&&V(URL.createObjectURL(s))};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"ml-1",children:s.jsx(g,{items:E})}),s.jsxs(r,{className:"max-w-8xl mt-3 mx-auto",children:[s.jsx(a,{children:s.jsx(l,{className:"text-xl font-semibold",children:"Add Supplier"})}),s.jsx(n,{children:s.jsx(j,{...D,children:s.jsxs("form",{onSubmit:D.handleSubmit((async function(e){B(!0),P(null);const s=new FormData;Object.keys(e).forEach((r=>{"image"===r&&e.image?s.append("image",e.image[0]):s.append(r,e[r])}));try{const e=await fetch("/api/supplier/add",{method:"POST",body:s});if(!e.ok)throw new Error("Failed to submit form");await e.json();await k(),await y.fire({title:"Success!",text:"Supplier added successfully",icon:"success",timer:2e3,showConfirmButton:!1}),F("/supplier-table")}catch(r){P("Failed to submit form. Please try again."),y.fire({title:"Error!",text:r.message||"Failed to add supplier",icon:"error"})}finally{B(!1)}})),className:"space-y-6",children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsx(x,{control:D.control,name:"name",render:({field:e})=>s.jsxs(h,{children:[s.jsxs(p,{children:["Supplier Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(u,{children:s.jsx(t,{placeholder:"Enter supplier name",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:D.control,name:"contact_person",render:({field:e})=>s.jsxs(h,{children:[s.jsx(p,{children:"Contact Person"}),s.jsx(u,{children:s.jsx(t,{placeholder:"Enter contact person",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:D.control,name:"email",render:({field:e})=>s.jsxs(h,{children:[s.jsxs(p,{children:["Email ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(u,{children:s.jsx(t,{placeholder:"Enter email address",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:D.control,name:"website",render:({field:e})=>s.jsxs(h,{children:[s.jsx(p,{children:"Website"}),s.jsx(u,{children:s.jsx(t,{placeholder:"Enter website URL",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:D.control,name:"mobile",render:({field:e})=>s.jsxs(h,{children:[s.jsx(p,{children:"Mobile Number"}),s.jsx(u,{children:s.jsx(t,{placeholder:"Enter mobile number",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:D.control,name:"country",render:({field:e})=>s.jsxs(h,{children:[s.jsxs(p,{children:["Country ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs(N,{onValueChange:s=>{e.onChange(s),(async e=>{try{const s=await fetch(`https://api.api-ninjas.com/v1/city?country=${e}&limit=30`,{headers:{"X-Api-Key":"YOUR_API_NINJAS_KEY"}}),r=(await s.json()).map((e=>e.name)).sort();_(r),D.setValue("city","")}catch(s){}})(s)},value:e.value,children:[s.jsx(u,{children:s.jsx(w,{children:s.jsx(S,{placeholder:"Select country"})})}),s.jsx(v,{children:O.map((e=>s.jsx(C,{value:e.name,children:e.name},e.code)))})]}),s.jsx(f,{})]})}),s.jsx(x,{control:D.control,name:"city",render:({field:e})=>s.jsxs(h,{children:[s.jsxs(p,{children:["City ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs(N,{onValueChange:e.onChange,value:e.value,disabled:!D.watch("country"),children:[s.jsx(u,{children:s.jsx(w,{children:s.jsx(S,{placeholder:"Select city"})})}),s.jsx(v,{children:T.map((e=>s.jsx(C,{value:e,children:e},e)))})]}),s.jsx(f,{})]})})]}),s.jsx(x,{control:D.control,name:"address",render:({field:e})=>s.jsxs(h,{children:[s.jsxs(p,{children:["Address ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(u,{children:s.jsx(b,{placeholder:"Enter address",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:D.control,name:"image",render:({field:e})=>s.jsxs(h,{children:[s.jsx(p,{children:"Upload Image"}),s.jsx(u,{children:s.jsx(t,{type:"file",...e,onChange:L})}),s.jsx(f,{})]})}),U&&s.jsxs("div",{className:"mt-4",children:[s.jsx("img",{src:U,alt:"Image preview",className:"w-32 h-32 object-cover rounded-lg"}),s.jsx(c,{type:"button",onClick:()=>V(null),className:"absolute top-0 right-0 bg-red-500 text-white p-1 rounded-full",children:s.jsx(i,{className:"h-4 w-4"})})]}),s.jsx("div",{className:"flex gap-4",children:s.jsx(c,{type:"submit",className:"bg-green-500 w-1/4 font-medium hover:bg-green-600 text-lg",disabled:A,children:"Save"})})]})})})]})]})}export{F as default};
//# sourceMappingURL=SupplierForm-D3HgVi0v.js.map
