import{aJ as e,ao as s,j as a,ai as l,ak as r,al as i,am as n,I as t,B as c,aQ as d,at as o,T as h,e as m,f as x,g as u,h as p,i as j,au as b,as as g,aR as N,P as f}from"./main-CzSo-TQq.js";import{b as v,f as y,R as w,L as C}from"./vendor-BCMiqwDy.js";import{A as S,a as k,b as L,c as D,d as _,e as A,f as I,g as P}from"./alert-dialog-DUYkMjib.js";import{B as O}from"./badge-drzyMCJ6.js";import{D as T,a as F,b as z,c as E}from"./dropdown-menu-DmD2_E8Q.js";import{E as $}from"./ellipsis-vertical-BKj02QtP.js";import{B as M}from"./BreadCrumb-DQTmRfsr.js";import"./utils-ZFgnvnbw.js";import"./index-C6jzH1EM.js";import"./chevron-right-BuWKzX76.js";import"./check-BBACUXZH.js";const B=({open:d,onClose:o,chemicalName:h,supplier:m,supplierId:x,refetch:u,allData:p})=>{const[j,b]=v.useState(""),[g,N]=v.useState([]),{data:f,isLoading:y,error:w}=e(j,{skip:!j||j.length<2}),[C,{isLoading:S}]=s();return a.jsx(l,{open:d,onOpenChange:e=>!e&&o(),children:a.jsxs(r,{className:"max-w-lg p-6",children:[a.jsx(i,{children:a.jsxs(n,{className:"text-lg font-semibold text-[#3b1f91]",children:["Add Chemicals for ",m]})}),a.jsxs("div",{className:"mt-4",children:[a.jsx(t,{placeholder:`Search ${m}`,value:j,onChange:e=>b(e.target.value),className:"w-full mb-4"}),y?a.jsx("div",{children:"Loading..."}):j&&f&&f.length>0&&a.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:f.map((e=>a.jsx("li",{onClick:()=>(e=>{N((s=>{const a=[...s,e];return b(""),a}))})(e),className:"p-2 hover:bg-gray-200 cursor-pointer",children:e.name},e._id)))}),0===f?.length&&!y&&j&&a.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),a.jsx("div",{className:"mt-4",children:g.length>0&&a.jsx("div",{className:"space-y-2",children:g.map((e=>a.jsxs("div",{className:"flex justify-between items-center bg-gray-100 p-2 rounded",children:[a.jsx("span",{children:e.name}),a.jsx(c,{variant:"outline",size:"sm",onClick:()=>{return s=e._id,void N((e=>e.filter((e=>e._id!==s))));var s},className:"text-red-500",children:"Remove"})]},e._id)))})}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsx(c,{onClick:async()=>{const e=g.map((e=>e._id));try{await C({supplierId:x,chemical_ids:e}).unwrap(),await u(),o(),p()}catch(s){}},className:"bg-[#3b1f91] hover:bg-purple-700",disabled:S||0===g.length,children:S?"Adding...":"+ Add"}),a.jsx(c,{onClick:o,className:"bg-red-600 hover:bg-red-700",children:"Cancel"})]})]})]})})};function R({supplier:e,supplierName:s,allData:l}){const[r,t]=v.useState(10),[g,N]=v.useState(1),[f,y]=v.useState(1),[w,C]=v.useState(!1),[O,T]=v.useState(null),[F,z]=v.useState(null),[E,$]=v.useState(!1),[M,R]=v.useState(null),{data:Q,isLoading:G,isError:J,refetch:U}=d(e,{skip:(g-1)*r,limit:r}),[V,{isLoading:W}]=o();v.useEffect((()=>{Q&&y(Math.ceil(Q.chemicals.length/r))}),[Q,r]);if(G)return a.jsx("div",{children:"Loading..."});if(J)return a.jsx("div",{children:"Error loading chemicals"});const q=Array.isArray(Q?.chemicals)?Q.chemicals:[];return a.jsxs("div",{className:"w-full overflow-auto",children:[a.jsx(i,{children:a.jsxs("div",{className:"flex justify-between items-center mr-5",children:[a.jsxs(n,{children:["Chemicals for ",s]}),a.jsx(c,{onClick:()=>(T(q),C(!0),void z("supplier")),className:"bg-purple-600 hover:bg-purple-700",children:"+ Add Chemical"})]})}),a.jsx("div",{className:"mt-5 ",children:a.jsxs(h,{children:[a.jsx(m,{children:a.jsxs(x,{children:[a.jsx(u,{className:"p-2",children:"Name"}),a.jsx(u,{className:"p-2",children:"CAS Number"}),a.jsx(u,{className:"p-2 w-[100px]",children:"Action"})]})}),a.jsx(p,{children:q.map(((e,s)=>a.jsxs(x,{className:"p-2",children:[a.jsx(j,{className:"px-2 py-1",children:e.name}),a.jsx(j,{className:"px-2 py-1",children:e.cas_number}),a.jsx(j,{className:"px-2 py-1",children:a.jsx(c,{variant:"ghost",size:"icon",className:"text-red-500",onClick:()=>(e=>{R(e),$(!0)})(e),disabled:W,children:W?"Deleting...":a.jsx(b,{className:"h-4 w-4"})})})]},s)))})]})}),w&&O&&a.jsx(B,{open:w,onClose:()=>C(!1),chemicalName:O.name,supplier:s,supplierId:e,refetch:U,allData:l}),a.jsx(S,{open:E,onOpenChange:$,children:a.jsxs(k,{children:[a.jsxs(L,{children:[a.jsx(D,{children:"Are you sure?"}),a.jsxs(_,{children:["This action cannot be undone. This will permanently delete the chemical",M&&` "${M.name}"`," from this supplier."]})]}),a.jsxs(A,{children:[a.jsx(I,{children:"Cancel"}),a.jsx(P,{onClick:async()=>{try{await V({supplierId:e,chemicalId:M._id}).unwrap(),U()}catch(s){}finally{$(!1),R(null)}},className:"bg-red-500 hover:bg-red-600",children:"Delete"})]})]})}),a.jsxs("div",{className:"flex items-center justify-between mt-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm",children:"Items per page:"}),a.jsxs("select",{className:"border p-1 rounded",value:r,onChange:e=>t(Number(e.target.value)),children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:20,children:"20"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(c,{variant:"outline",size:"sm",onClick:()=>{g>1&&N(g-1)},disabled:1===g,children:"Previous"}),a.jsxs("span",{children:[g," of ",f]}),a.jsx(c,{variant:"outline",size:"sm",onClick:()=>{g<f&&N(g+1)},disabled:g===f,children:"Next"})]})]})]})}const Q=()=>{const{data:e=[],isLoading:s,error:i}=g(),[n,t]=v.useState(1),[d,o]=v.useState(10),[b,f]=v.useState(!1),[C,S]=v.useState(null),[k,L]=v.useState({name:"",email:"",mobile:"",country:"",website:""}),D=y(),[_,A]=v.useState(null),[I,P]=v.useState(!1),{refetch:M}=g(),[Q]=N(),G=(e,s)=>{L((a=>({...a,[e]:s}))),t(1)},J=e.filter((e=>{const s=k.name.toLowerCase();return(!k.name||e.name.toLowerCase().includes(s)||e.email.toLowerCase().includes(s)||e.mobile.toLowerCase().includes(s))&&(!k.country||e.country.toLowerCase().includes(k.country.toLowerCase()))&&(!k.website||e.website.toLowerCase().includes(k.website.toLowerCase()))})),U=Math.ceil(J.length/d),V=J.slice((n-1)*d,n*d);return s?a.jsx("div",{children:"Loading..."}):i?a.jsxs("div",{children:["Error loading suppliers: ",i.message]}):a.jsxs("div",{children:[a.jsx("div",{className:"rounded-md shadow-sm bg-white",children:a.jsxs(h,{className:"w-full text-left border-collapse",children:[a.jsxs(m,{className:"bg-gray-100 border-b border-gray-300",children:[a.jsxs(x,{className:"text-gray-600 font-semibold",children:[a.jsx(u,{className:"w-10"}),a.jsx(u,{children:"Info"}),a.jsx(u,{children:"Chemicals"}),a.jsx(u,{children:"Country"}),a.jsx(u,{children:"Website"})]}),a.jsxs(x,{className:"bg-gray-50",children:[a.jsx(j,{}),a.jsx(j,{children:a.jsx("input",{type:"text",placeholder:"Filter by name, email or mobile",className:"p-2 rounded w-full border border-gray-300",value:k.name,onChange:e=>G("name",e.target.value)})}),a.jsx(j,{}),a.jsx(j,{children:a.jsx("input",{type:"text",placeholder:"Filter by country",className:"p-2 rounded w-full border border-gray-300",value:k.country,onChange:e=>G("country",e.target.value)})}),a.jsx(j,{children:a.jsx("input",{type:"text",placeholder:"Filter by website",className:"p-2 rounded w-full border border-gray-300",value:k.website,onChange:e=>G("website",e.target.value)})})]})]}),a.jsx(p,{children:V.map((e=>a.jsx(w.Fragment,{children:a.jsxs(x,{className:"hover:bg-gray-50 border-b border-gray-300",children:[a.jsx(j,{className:"p-2",children:a.jsxs(T,{children:[a.jsx(F,{asChild:!0,children:a.jsx("button",{className:"p-3",children:a.jsx($,{className:"w-4 h-4"})})}),a.jsxs(z,{align:"end",children:[a.jsx(E,{onClick:()=>(e=>{S(e),f(!0)})(e),children:"Add Chemical"}),a.jsx(E,{onClick:()=>D(`/edit-supplier-form/${e._id}`),children:"Edit"}),a.jsx(E,{onClick:()=>(async e=>{try{await Q(e)}catch(s){}})(e._id),children:"Delete"})]})]})}),a.jsx(j,{children:a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"font-medium",children:e.name}),a.jsx("span",{className:"text-sm text-gray-600",children:e.email}),a.jsx("span",{className:"text-sm text-gray-600",children:e.mobile})]})}),a.jsx(j,{children:a.jsxs(c,{variant:"default",size:"sm",onClick:()=>(e=>{A(e),P(!0)})(e),className:"bg-[#3b1f91] text-white px-4 py-2 rounded hover:bg-[#3b1f91] transition-colors duration-300",children:["Chemicals",a.jsx(O,{variant:"secondary",className:"ml-2 bg-gray-200 text-black px-2 py-1 rounded",children:e.totalChemicalIds||0})]})}),a.jsx(j,{children:e.country}),a.jsx(j,{children:a.jsx(Link,{to:e.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:e.website})})]})},e._id)))})]})}),a.jsxs("div",{className:"flex justify-between items-center mt-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"items-per-page",className:"mr-2",children:"Items per page:"}),a.jsxs("select",{id:"items-per-page",className:"p-2  border border-gray-300 rounded",value:d,onChange:e=>{o(parseInt(e.target.value)),t(1)},children:[a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:20,children:"20"}),a.jsx("option",{value:30,children:"30"}),a.jsx("option",{value:40,children:"40"}),a.jsx("option",{value:50,children:"50"})]})]}),a.jsxs("div",{children:[a.jsx("button",{onClick:()=>t((e=>Math.max(e-1,1))),className:"px-3 py-1 border border-gray-300 rounded mr-2",disabled:1===n,children:"Previous"}),a.jsxs("span",{children:["Page ",n," of ",U]}),a.jsx("button",{onClick:()=>t((e=>Math.min(e+1,U))),className:"px-3 py-1 border border-gray-300 rounded ml-2",disabled:n===U,children:"Next"})]})]}),b&&a.jsx(B,{open:b,onClose:()=>f(!1),supplier:C,supplierId:C?._id,chemicalName:C?.name}),a.jsx(l,{open:I,onOpenChange:P,children:a.jsx(r,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:I&&_&&a.jsx(R,{supplier:_._id,supplierName:_.name,allData:M})})})]})},G=({purchaseOrders:e})=>a.jsxs(h,{children:[a.jsx(m,{children:a.jsxs(x,{children:[a.jsx(u,{children:"Created Date"}),a.jsx(u,{children:"Order Number"}),a.jsx(u,{children:"Payment Status"}),a.jsx(u,{children:"Total Tax"}),a.jsx(u,{children:"Total Discount"}),a.jsx(u,{children:"Total Amount"})]})}),a.jsx(p,{children:e.map(((e,s)=>a.jsxs(x,{children:[a.jsx(j,{children:e.createdDate}),a.jsx(j,{children:e.orderNumber}),a.jsx(j,{children:e.paymentStatus}),a.jsxs(j,{children:["$",e.totalTax]}),a.jsxs(j,{children:["$",e.totalDiscount]}),a.jsxs(j,{children:["$",e.totalAmount]})]},s)))})]}),J=[{label:"Dashboard",href:"/dashboard"},{label:"Supplier Table",href:null}];function U(){const[e,s]=v.useState({}),[i,n]=v.useState(!1),[t,d]=v.useState(null),[o,h]=v.useState(1),[m,x]=v.useState(5),{data:u=[],isLoading:p,error:j,refetch:b}=g(),[N,y]=v.useState({});if(p)return a.jsx("p",{children:"Loading suppliers..."});if(j)return a.jsx("p",{children:"Failed to load suppliers"});return a.jsxs("div",{className:"",children:[a.jsx(M,{items:J}),a.jsxs("div",{className:"flex justify-between mt-4 items-center mb-6",children:[a.jsx("h1",{className:"text-2xl font-medium text-[#3b1f91] ",children:"Suppliers"}),a.jsx(C,{to:"/supplier-form",children:a.jsxs(c,{children:[a.jsx(f,{className:"w-4 h-4 mr-2"}),"Add Supplier"]})})]}),a.jsx(Q,{suppliers:u,showPurchaseOrders:e,setShowPurchaseOrders:s,setSelectedSupplier:d,setShowChemicalsModal:n,filters:N,handleFilterChange:(e,s)=>{y((a=>({...a,[e]:s})))},currentPage:o,itemsPerPage:m,paginatedData:u.slice((o-1)*m,o*m),selectedSupplier:t,refetch:b,onChemicalClick:e=>{d(e),n(!0)}}),e[t?.id]&&t&&a.jsxs("div",{className:"mt-6",children:[a.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Purchase Orders for ",t.name]}),a.jsx(G,{purchaseOrders:[]}),"  "]}),a.jsx(l,{open:i,onOpenChange:e=>{n(e)},children:a.jsx(r,{className:"max-w-2xl h-1/2",children:a.jsx(R,{supplier:t?._id,supplierName:t?.name,allData:b})})})]})}export{U as default};
//# sourceMappingURL=SupplierTablePage-n4IliDbr.js.map
