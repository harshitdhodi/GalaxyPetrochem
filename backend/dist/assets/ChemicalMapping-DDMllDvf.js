import{n as e,j as t,I as a,B as s,r as i,aa as l,ab as r}from"./main-DbCIA5nM.js";import{b as n,R as o}from"./vendor-X2E3PIZN.js";import{a as c}from"./utils-ZFgnvnbw.js";import{F as d,P as m}from"./Table-DuH0XXff.js";import{M as p}from"./index-s4gvY70H.js";import{B as h}from"./index-CvhnQ2ZS.js";import"./objectSpread2-C2mPdFQ-.js";import"./AntdIcon-Bc_RgQsY.js";import"./addEventListener-Dm19rJS7.js";import"./toArray-DIarnBRF.js";import"./index-TlfG7RwS.js";import"./index-Cie-PtDs.js";import"./dropdown-C2Lyn6ws.js";import"./getAllowClear-CF0z5FWe.js";import"./CheckOutlined-qoM0f-f3.js";import"./Input-DzV7KJ8a.js";import"./index-DKxChPud.js";import"./index-CoLLPh3Y.js";import"./CheckCircleFilled-vSnFSXRd.js";import"./ExclamationCircleFilled-jOtwz4nB.js";import"./InfoCircleFilled-BiVI0bqr.js";import"./ActionButton-9gw_uhHA.js";import"./index-CjgsjwJv.js";import"./index-BJvm14ET.js";import"./fade-CZ8b_ilM.js";import"./Skeleton-Ds91yGkQ.js";function u({selectedSupplier:i,onAddChemical:l}){const[r,o]=n.useState(""),[d,m]=n.useState(""),[p,h]=n.useState(null),[u,j]=n.useState([]),[x,g]=n.useState(!1),[f,{isLoading:S}]=e();return t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(a,{placeholder:"Search Chemical",value:r,onChange:e=>{const t=e.target.value;o(t),t.trim()?(m(t),(async e=>{if(e){g(!0);try{const t=await c.get(`/api/chemical/getChemicalByCategoryAndAlphabet?alphabet=${e}`);j(t.data)}catch(t){j([])}finally{g(!1)}}})(t.charAt(0))):(m(""),j([]))},className:"w-full mb-4",disabled:!i}),x&&t.jsx("div",{className:"absolute top-2 right-4 text-sm text-gray-500",children:"Loading..."})]}),d&&u?.length>0&&t.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:u.map((e=>t.jsx("li",{onClick:()=>(e=>{h(e),o(e.name),m("")})(e),className:"p-2 hover:bg-gray-200 cursor-pointer border-b last:border-b-0",children:e.name},e._id)))}),0===u?.length&&!x&&d&&t.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),t.jsx(s,{onClick:async()=>{if(p&&i)try{const e=p._id,t=i._id;await f({supplierId:t,chemical_ids:[e]}).unwrap(),h(null),o(""),l&&l()}catch(e){alert(`Failed to add chemical: ${e.message||"Unknown error occurred"}`)}},disabled:S||!p||!i,className:"mt-4 w-fit py-2 bg-blue-500 text-white rounded hover:bg-blue-600 "+(S?"opacity-50 cursor-not-allowed":""),children:S?"Adding...":"Add Chemical"})]})}function j({chemicals:e,refetch:a,supplierId:s,onRemoveChemical:l}){const[r,o]=n.useState(1),[c,u]=n.useState(10),[j]=i(),[x,g]=n.useState(null),[f,S]=n.useState(!1);Math.ceil(e.length/c);const b=(r-1)*c,C=b+c,y=e.slice(b,C),v=[{title:"Action",dataIndex:"action",render:(e,a)=>t.jsx(h,{danger:!0,size:"small",onClick:()=>(e=>{g(e),S(!0)})(a),children:"Delete"})},{title:"Chemical Name",dataIndex:"name"},{title:"CAS Number",dataIndex:"cas_number"}];return t.jsxs("div",{className:"border rounded-md mt-4 p-4",children:[t.jsx(d,{dataSource:y,columns:v,rowKey:"_id",pagination:!1}),t.jsx(m,{current:r,total:e.length,pageSize:c,onChange:e=>o(e),showSizeChanger:!0,onShowSizeChange:(e,t)=>u(t),className:"mt-4 float-end pt-5"}),t.jsx(p,{title:"Confirm Deletion",open:f,onCancel:()=>S(!1),onOk:async()=>{if(s&&x)try{await j({supplierId:s,chemicalId:x._id}),l(x),a(),S(!1),g(null),1===y.length&&r>1&&o(1)}catch(e){}},okText:"Delete",okButtonProps:{danger:!0},children:t.jsxs("p",{children:['Are you sure you want to delete "',x?.name,'"?']})})]})}function x({onSelectSupplier:e}){const[s,i]=n.useState(""),[o,c]=n.useState(""),[d,m]=n.useState(null),{data:p,isLoading:h}=l(o.charAt(0),{skip:0===o.length}),{data:x,refetch:g,isFetching:f}=r(d?._id,{skip:!d});n.useEffect((()=>{x&&!f&&(m(x),"function"==typeof e&&e(x))}),[x,f,e]);const S=()=>{g()};return t.jsxs("div",{className:"mt-4",children:[t.jsx(a,{placeholder:"Search Supplier",value:s,onChange:e=>{const t=e.target.value;i(t),c(t)},className:"w-full mb-4"}),h?t.jsx("div",{children:"Loading..."}):o&&p&&p.length>0&&t.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:p.map((a=>t.jsx("li",{onClick:()=>(t=>{m(t),i(t.name),c(""),"function"==typeof e&&e(t)})(a),className:"p-2 hover:bg-gray-200 cursor-pointer",children:a.name},a.id)))}),0===p?.length&&!h&&o&&t.jsx("div",{className:"p-2 text-gray-500",children:"No Supplier found"}),f&&t.jsx("div",{className:"p-2 text-gray-500",children:"Refreshing supplier data..."}),t.jsx(u,{selectedSupplier:d,onAddChemical:S}),t.jsx("div",{className:"mt-4",children:t.jsx(j,{chemicals:d?.chemical_ids||[],refetch:g,onRemoveChemical:S,supplierId:d?._id})})]})}function g(){const[e,a]=o.useState(null),[s,i]=o.useState([]);return t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-purple-700",children:"Assign Chemicals to Supplier"}),t.jsx("div",{className:"space-y-4",children:t.jsx(x,{onSelectCustomer:e=>{a(e),i([])}})})]})}export{g as default};
//# sourceMappingURL=ChemicalMapping-DDMllDvf.js.map
