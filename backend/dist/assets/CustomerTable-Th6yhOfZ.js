import{aJ as e,j as s,ai as a,ak as r,al as l,am as c,I as i,B as n,ba as d,ax as t,P as h,T as o,e as m,f as x,g as j,h as u,i as p,bb as b,av as g,aP as N}from"./main-CYgOQvaw.js";import{b as f,L as C}from"./vendor-BCMiqwDy.js";import{D as v,a as y,b as w,c as k}from"./dropdown-menu-B6gXWCPt.js";import{a as _}from"./utils-ZFgnvnbw.js";import{T as S}from"./trash-CQrmN3-n.js";import{B as A}from"./BreadCrumb-CCpOg2-Q.js";import{C as F}from"./chevron-up-LTThVSTS.js";import{E as I}from"./ellipsis-vertical-ChcJ7FXi.js";import"./index-D3SX27xu.js";import"./chevron-right-BHJrePhs.js";import"./check-BmKpgWX1.js";const O=({open:d,onOpenChange:t,customerId:h,onAddChemical:o,customerRefatch:m,refetch:x})=>{const[j,u]=f.useState(""),[p,b]=f.useState([]),{data:g,isLoading:N,error:C}=e(j,{skip:!j||j.length<2});return s.jsx(a,{open:d,onOpenChange:e=>!e&&t(!1),children:s.jsxs(r,{className:"max-w-lg p-6",children:[s.jsx(l,{children:s.jsx(c,{className:"text-lg font-semibold text-[#3b1f91]",children:"Add Chemicals to Customer"})}),s.jsxs("div",{className:"mt-4",children:[s.jsx(i,{placeholder:"Search chemicals",value:j,onChange:e=>u(e.target.value),className:"w-full mb-4"}),N?s.jsx("div",{children:"Loading..."}):j&&g&&g.length>0&&s.jsx("ul",{className:"border bg-white rounded max-h-40 overflow-y-auto",children:g.filter((e=>!p.some((s=>s._id===e._id)))).map((e=>s.jsx("li",{onClick:()=>(e=>{p.some((s=>s._id===e._id))||b((s=>{const a=[...s,e];return u(""),a}))})(e),className:"p-2 hover:bg-gray-200 cursor-pointer",children:e.name},e._id)))}),0===g?.length&&!N&&j&&s.jsx("div",{className:"p-2 text-gray-500",children:"No chemicals found"}),s.jsx("div",{className:"mt-4",children:p.length>0&&s.jsx("div",{className:"space-y-2",children:p.map((e=>s.jsxs("div",{className:"flex justify-between items-center bg-gray-100 p-2 rounded",children:[s.jsx("span",{children:e.name}),s.jsx(n,{variant:"outline",size:"sm",onClick:()=>{return s=e._id,b((e=>e.filter((e=>e._id!==s)))),void x();var s},className:"text-red-500",children:"Remove"})]},e._id)))})}),s.jsxs("div",{className:"flex justify-between mt-4",children:[s.jsx(n,{onClick:async()=>{const e=p.map((e=>e._id)),s={id:h,chemicalId:e};try{await _.put(`/api/customer/addChemicalIdsToCustomer?id=${h}`,s,{headers:{"Content-Type":"application/json"}}),t(!1),o&&o(p),m(),x()}catch(a){}},className:"bg-[#3b1f91] hover:bg-purple-700",disabled:0===p.length,children:"+ Add Chemicals"}),s.jsx(n,{onClick:()=>t(!1),className:"bg-red-600 hover:bg-red-700",children:"Cancel"})]})]})]})})},D=({customerId:e,customerName:i,open:b,onOpenChange:g,customerRefatch:N})=>{const[C,v]=f.useState(!1),{data:y,isLoading:w,isError:k,refetch:_}=d(e,{skip:!b}),[A,{isLoading:F}]=t();if(w)return s.jsx(a,{open:b,onOpenChange:g,children:s.jsxs(r,{children:[s.jsx(l,{children:s.jsx(c,{children:"Loading Chemicals..."})}),s.jsx("p",{children:"Fetching chemical data..."})]})});if(k)return s.jsx(a,{open:b,onOpenChange:g,children:s.jsxs(r,{children:[s.jsx(l,{children:s.jsx(c,{children:"Error Loading Chemicals"})}),s.jsx("p",{children:"Unable to fetch chemical data. Please try again."})]})});const I=y?.data?.chemicalId||[];return s.jsxs(s.Fragment,{children:[s.jsx(a,{open:b,onOpenChange:g,children:s.jsxs(r,{className:"max-w-3xl",children:[s.jsx(l,{children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs(c,{children:["Chemicals for ",i]}),s.jsxs(n,{className:"m-3",onClick:()=>v(!0),children:[s.jsx(h,{className:"mr-2 h-4 w-4"})," Add Chemical"]})]})}),I.length>0?s.jsxs(o,{children:[s.jsx(m,{children:s.jsxs(x,{children:[s.jsx(j,{children:"Name"}),s.jsx(j,{children:"CAS Number"}),s.jsx(j,{children:"Actions"})," "]})}),s.jsx(u,{children:I.map((a=>s.jsxs(x,{children:[s.jsx(p,{children:a.name}),s.jsx(p,{children:a.cas_number}),s.jsx(p,{children:s.jsx(n,{variant:"destructive",size:"sm",onClick:()=>(async s=>{try{await A({customerId:e,chemicalId:s}),_()}catch(a){}})(a._id),disabled:F,children:s.jsx(S,{})})})]},a._id)))})]}):s.jsx("p",{className:"text-center py-4",children:"No chemicals found for this customer"})]})}),s.jsx(O,{open:C,onOpenChange:v,customerId:e,onAddChemical:e=>{v(!1)},customerRefatch:N,refetch:_})]})},T=({salesOrders:e=[]})=>s.jsxs(o,{children:[s.jsx(m,{children:s.jsxs(x,{children:[s.jsx(j,{children:"Created Date"}),s.jsx(j,{children:"Order Number"}),s.jsx(j,{children:"Payment Status"}),s.jsx(j,{children:"Total Discount"}),s.jsx(j,{children:"Total Tax"}),s.jsx(j,{children:"Total Amount"})]})}),s.jsx(u,{children:0===e.length?s.jsx(x,{children:s.jsx(p,{colSpan:6,className:"text-center",children:"No Data Found"})}):e.map((e=>s.jsxs(x,{children:[s.jsx(p,{children:e.createdDate}),s.jsx(p,{children:e.orderNumber}),s.jsx(p,{children:e.paymentStatus}),s.jsx(p,{children:e.totalDiscount}),s.jsx(p,{children:e.totalTax}),s.jsx(p,{children:e.totalAmount})]},e.orderNumber)))})]}),L=[{label:"Dashboard",href:"/dashboard"},{label:"Customer Table",href:"/supplier-table"}],E=()=>{const[e,a]=f.useState(null),[r,l]=f.useState(!1),[c,d]=f.useState(null),[t]=b(),[_,S]=f.useState(!1),[E,P]=f.useState(!1),{data:z,isLoading:R,error:B,refetch:$}=g(),J=z||[];if(R)return s.jsx("div",{children:"Loading..."});if(B)return s.jsx("div",{children:"Error loading customers"});const M=e=>{};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"ml-1",children:s.jsx(A,{items:L})}),s.jsxs("div",{className:"space-y-4 mt-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-xl font-medium text-[#3b1f91]",children:"Customers"}),s.jsx(C,{to:"/customer-form",children:s.jsxs(n,{children:[s.jsx(h,{className:"mr-2 h-4 w-4 "}),"Add Customer"]})})]}),s.jsx("hr",{className:"border-[#3b1f91] border my-4"}),s.jsx("div",{className:"rounded-md border",children:s.jsxs(o,{children:[s.jsx(m,{className:"bg-gray-100 ",children:s.jsxs(x,{children:[s.jsx(j,{className:"w-[50px] border-r-gray-300 bg-gray-100"}),s.jsx(j,{className:"text-black border-r-gray-300 font-semibold",children:"Name"}),s.jsx(j,{className:"text-black border-r-gray-300 font-semibold",children:"Contact Person"}),s.jsx(j,{className:"text-black border-r-gray-300 font-semibold",children:"Email"}),s.jsx(j,{className:"text-black border-r-gray-300 font-semibold",children:"Mobile/Phone"}),s.jsx(j,{className:"text-black border-r-gray-300 font-semibold",children:"Website"}),s.jsx(j,{className:"text-black  font-semibold",children:"Chemicals Count"})]})}),s.jsxs(u,{children:[s.jsxs(x,{className:"bg-gray-100",children:[s.jsx(p,{}),s.jsx(p,{children:s.jsx(i,{placeholder:"Filter name...",className:"max-w-sm"})}),s.jsx(p,{children:s.jsx(i,{placeholder:"Filter contact...",className:"max-w-sm"})}),s.jsx(p,{children:s.jsx(i,{placeholder:"Filter email...",className:"max-w-sm"})}),s.jsx(p,{children:s.jsx(i,{placeholder:"Filter phone...",className:"max-w-sm"})}),s.jsx(p,{children:s.jsx(i,{placeholder:"Filter website...",className:"max-w-sm"})}),s.jsx(p,{children:s.jsx(i,{placeholder:"Filter chemicals...",className:"max-w-sm"})})]}),J.map((r=>s.jsxs(s.Fragment,{children:[s.jsxs(x,{children:[s.jsx(p,{children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(n,{variant:"ghost",size:"sm",onClick:()=>{return e=r.id,void a((s=>s===e?null:e));var e},children:e===r.id?s.jsx(F,{className:"h-4 w-4"}):s.jsx(N,{className:"h-4 w-4"})}),s.jsxs(v,{children:[s.jsx(y,{asChild:!0,children:s.jsx(n,{variant:"ghost",size:"sm",children:s.jsx(I,{className:"h-4 w-4"})})}),s.jsxs(w,{align:"end",children:[s.jsx(C,{to:`/edit-customer-form/${r._id}`,children:s.jsx(k,{children:"Edit"})}),s.jsx(k,{className:"text-red-600",onClick:()=>(async e=>{try{S(!0),await t(e),alert("Customer deleted successfully")}catch(s){alert("Failed to delete customer")}finally{S(!1)}})(r._id),disabled:_,children:_?"Deleting...":"Delete"}),s.jsx(k,{onClick:()=>{d(r),P(!0)},children:"Add Chemical"})]})]})]})}),s.jsx(p,{children:r.name}),s.jsx(p,{children:r.contactPerson}),s.jsx(p,{children:r.email}),s.jsx(p,{children:r.phone}),s.jsx(p,{children:r.website}),s.jsx(p,{children:s.jsxs(n,{className:"hover:bg-[#4f359c]",variant:"secondary",size:"sm",onClick:()=>(e=>{d(e),l(!0)})(r),children:["Chemicals (",r.chemicalId.length,")"]})})]},r.id),e===r.id&&s.jsx(x,{children:s.jsx(p,{colSpan:9,children:s.jsx("div",{className:"p-4",children:s.jsx(T,{customerId:r._id})})})})]})))]})]})}),s.jsx(D,{open:r,onOpenChange:l,customerName:c?.name,customerId:c?._id,onAddChemical:M,customerRefatch:$}),s.jsx(O,{open:E,onOpenChange:P,onAddChemical:M,customerId:c?._id})]})]})};export{E as default};
//# sourceMappingURL=CustomerTable-Th6yhOfZ.js.map
