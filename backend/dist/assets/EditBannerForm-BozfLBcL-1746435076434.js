import{g as D,u as O,r as m,cs as T,ct as A,cp as Q,j as t,L as F,al as G,a as k}from"./index-HqVKJZ4m-1746435076434.js";import{F as o}from"./index-DynmQ1pY-1746435076434.js";import{B as n}from"./Breadcrumb-BoS4HQ-Q-1746435076434.js";import{R as _}from"./HomeOutlined-B2gFRfwg-1746435076434.js";import{S as y}from"./index-DApcI_0j-1746435076434.js";import{U as S,R as P}from"./index-CXZPHdHy-1746435076434.js";import{B as d}from"./index-7xeFzZ3q-1746435076434.js";import{I as g}from"./index-CBYpSiB_-1746435076434.js";import{s}from"./index-BOknFwzt-1746435076434.js";import"./toArray-DeWF-CPR-1746435076434.js";import"./extends-rM07bN2b-1746435076434.js";import"./AntdIcon-CvcpUYMf-1746435076434.js";import"./index-CIT_ixrI-1746435076434.js";import"./CheckCircleFilled-DMl_gSy3-1746435076434.js";import"./ExclamationCircleFilled-CQvkp_Tz-1746435076434.js";import"./dropdown-BgvYK5wC-1746435076434.js";import"./EllipsisOutlined-DVUV-35c-1746435076434.js";import"./getAllowClear-Eq9A1qme-1746435076434.js";import"./CheckOutlined-BBjfclKA-1746435076434.js";import"./Input-CrgwD5p--1746435076434.js";import"./fade-C5lTo8po-1746435076434.js";import"./DeleteOutlined-zl6VoJtd-1746435076434.js";import"./DownloadOutlined-CA7Z2jb9-1746435076434.js";import"./EyeOutlined-DND7IRbh-1746435076434.js";import"./TextArea-ByN1qHQ1-1746435076434.js";import"./InfoCircleFilled-ut5AbCP0-1746435076434.js";const{Option:z}=y,je=()=>{const{id:c}=D(),B=O(),[l]=o.useForm(),[p,L]=m.useState(!1),[u,w]=m.useState(!1),[C,E]=m.useState([]),{data:e,isLoading:b,refetch:U}=T(c),[q]=A(),{refetch:$}=Q();m.useEffect(()=>{(async()=>{try{const r=await k.get("/api/menulist/get-menu");r.data.success&&E(r.data.data)}catch(r){console.error("Error fetching menu list:",r),s.error("Failed to fetch menu list")}})()},[]),m.useEffect(()=>{e&&l.setFieldsValue({title:e.title,altName:e.altName,details:e.details,imgName:e.imgName,pageSlug:e.pageSlug||"",image:e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[],photo:e.photo?[{name:e.photoName,url:`/api/photo/download/${e.photo}`}]:[]})},[e,l]);const M=a=>{L(!0),l.setFieldsValue({imgName:a.file.name,image:a.fileList})},R=a=>{w(!0),l.setFieldsValue({photo:a.fileList})},V=async a=>{var r,h,f,x,j,N,I;try{if(!((r=a.title)!=null&&r.trim())){s.error("Title is required");return}if(!((h=a.altName)!=null&&h.trim())){s.error("Alt Name is required");return}if(!a.pageSlug){s.error("Page Slug is required");return}const i=new FormData;p&&((x=(f=a.image)==null?void 0:f[0])!=null&&x.originFileObj)?(i.append("image",a.image[0].originFileObj),i.append("imgName",a.image[0].name)):i.append("imgName",a.imgName||e.imgName),u&&((N=(j=a.photo)==null?void 0:j[0])!=null&&N.originFileObj)?i.append("photo",a.photo[0].originFileObj):e.photo&&i.append("photo",e.photo),i.append("title",a.title.trim()),i.append("altName",a.altName.trim()),i.append("details",((I=a.details)==null?void 0:I.trim())||""),i.append("pageSlug",a.pageSlug),await q({id:c,bannerData:i}),s.success("Banner updated successfully"),U(),$(),B("/banner-table")}catch(i){console.error(i),s.error("Failed to update banner")}};return b?t.jsx("div",{children:"Loading..."}):t.jsxs("div",{children:[t.jsxs(n,{style:{padding:"16px 24px"},children:[t.jsx(n.Item,{children:t.jsxs(F,{to:"/dashboard",children:[t.jsx(_,{})," Dashboard"]})}),t.jsx(n.Item,{children:t.jsx(F,{to:"/banner-table",children:"Banner Management"})}),t.jsx(n.Item,{children:"Edit Banner"})]}),t.jsxs("div",{style:{padding:"24px"},children:[t.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Edit Banner"}),t.jsxs(o,{form:l,layout:"vertical",onFinish:V,initialValues:{title:(e==null?void 0:e.title)||"",altName:(e==null?void 0:e.altName)||"",details:(e==null?void 0:e.details)||"",imgName:(e==null?void 0:e.imgName)||"",pageSlug:(e==null?void 0:e.pageSlug)||"",image:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[],photo:e!=null&&e.photo?[{name:e.photoName,url:`/api/image/download/${e.photo}`}]:[]},children:[t.jsx(o.Item,{name:"pageSlug",label:"Page Slug",rules:[{required:!0,message:"Please select a Page Slug!"}],children:t.jsx(y,{placeholder:"Select Page Slug",children:C.map(a=>t.jsx(z,{value:a.parent.path,children:a.parent.name},a._id))})}),t.jsx(o.Item,{name:"image",label:"Banner Image",valuePropName:"fileList",getValueFromEvent:a=>a&&a.fileList,children:t.jsx(S,{maxCount:1,listType:"picture",beforeUpload:()=>!1,onChange:M,defaultFileList:e!=null&&e.image?[{name:e.imgName,url:`/api/image/download/${e.image}`}]:[],children:t.jsx(d,{icon:t.jsx(P,{}),children:p?"Change Image":"Upload New Image"})})}),t.jsx(o.Item,{name:"photo",label:"Photo",valuePropName:"fileList",getValueFromEvent:a=>a&&a.fileList,children:t.jsx(S,{maxCount:1,listType:"picture",beforeUpload:()=>!1,onChange:R,defaultFileList:e!=null&&e.photo?[{name:e.photoName,url:`/api/photo/download/${e.photo}`}]:[],children:t.jsx(d,{icon:t.jsx(P,{}),children:u?"Change Photo":"Upload New Photo"})})}),t.jsx(o.Item,{name:"imgName",label:"Image Name",rules:[{required:!0,message:"Please input image name!"}],children:t.jsx(g,{disabled:p})}),t.jsx(o.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Please input title!"}],children:t.jsx(g,{})}),t.jsx(o.Item,{name:"altName",label:"Alt Name",rules:[{required:!0,message:"Please input alt name!"}],children:t.jsx(g,{})}),t.jsx(o.Item,{name:"details",label:"Details",rules:[{message:"Please input details!"}],children:t.jsx(G,{theme:"snow"})}),t.jsx(o.Item,{children:t.jsx(d,{type:"primary",htmlType:"submit",children:"Update"})})]})]})]})};export{je as default};
