import{q as e,j as s,I as r,B as a,X as l}from"./main-DbCIA5nM.js";import{f as n,b as t}from"./vendor-X2E3PIZN.js";import{b as c}from"./index.esm-Dk3WekSX.js";import{C as i,b as o,c as d,a as m}from"./card-CgiS1VlC.js";import{F as j,a as x,b as h,c as p,d as u,e as f}from"./form-Cfi1c2h8.js";import{T as b}from"./textarea-uyS90DRv.js";import{B as g}from"./BreadCrumb-BYTrRWt1.js";import{S as y}from"./sweetalert2.esm.all-D2QuJ--x.js";import{S as N,a as w,b as S,c as v,d as C}from"./select-BGPtewlQ.js";import"./utils-ZFgnvnbw.js";import"./chevron-right-BX1oQPFZ.js";import"./index-BoWlxZtN.js";import"./index-DPOpahcV.js";import"./check-DSfnMMtB.js";import"./chevron-up-D_C2ouKf.js";const E=[{label:"Dashboard",href:"/dashboard"},{label:"Supplier Table",href:"/supplier-table"},{label:"Supplier Form",href:"/supplier-form"}];function F(){const F=n(),[I,A]=t.useState(!1),[P,U]=t.useState(null),[_,k]=t.useState(null),{refetch:B}=e(),L=c({defaultValues:{supplierName:"",contactPerson:"",email:"",website:"",mobileNumber:"",phoneNumber:"",address:"",country:"",city:"",description:"",image:null}}),[O,R]=t.useState([]),[V,T]=t.useState([]);t.useEffect((()=>{fetch("https://restcountries.com/v3.1/all").then((e=>e.json())).then((e=>{const s=e.map((e=>({name:e.name.common,code:e.cca2}))).sort(((e,s)=>e.name.localeCompare(s.name)));R(s)})).catch((e=>{}))}),[]);const D=e=>{const s=e.target.files[0];s&&k(URL.createObjectURL(s))};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"ml-1",children:s.jsx(g,{items:E})}),s.jsxs(i,{className:"max-w-8xl mt-3 mx-auto",children:[s.jsx(o,{children:s.jsx(d,{className:"text-xl font-semibold",children:"Add Supplier"})}),s.jsx(m,{children:s.jsx(j,{...L,children:s.jsxs("form",{onSubmit:L.handleSubmit((async function(e){A(!0),U(null);const s=new FormData;Object.keys(e).forEach((r=>{"image"===r&&e.image?s.append("image",e.image[0]):s.append(r,e[r])}));try{const e=await fetch("/api/supplier/add",{method:"POST",body:s});if(!e.ok)throw new Error("Failed to submit form");await e.json();await B(),await y.fire({title:"Success!",text:"Supplier added successfully",icon:"success",timer:2e3,showConfirmButton:!1}),F("/supplier-table")}catch(r){U("Failed to submit form. Please try again."),y.fire({title:"Error!",text:r.message||"Failed to add supplier",icon:"error"})}finally{A(!1)}})),className:"space-y-6",children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsx(x,{control:L.control,name:"name",render:({field:e})=>s.jsxs(h,{children:[s.jsxs(p,{children:["Supplier Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(u,{children:s.jsx(r,{placeholder:"Enter supplier name",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:L.control,name:"contact_person",render:({field:e})=>s.jsxs(h,{children:[s.jsx(p,{children:"Contact Person"}),s.jsx(u,{children:s.jsx(r,{placeholder:"Enter contact person",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:L.control,name:"email",render:({field:e})=>s.jsxs(h,{children:[s.jsxs(p,{children:["Email ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(u,{children:s.jsx(r,{placeholder:"Enter email address",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:L.control,name:"website",render:({field:e})=>s.jsxs(h,{children:[s.jsx(p,{children:"Website"}),s.jsx(u,{children:s.jsx(r,{placeholder:"Enter website URL",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:L.control,name:"mobile",render:({field:e})=>s.jsxs(h,{children:[s.jsx(p,{children:"Mobile Number"}),s.jsx(u,{children:s.jsx(r,{placeholder:"Enter mobile number",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:L.control,name:"country",render:({field:e})=>s.jsxs(h,{children:[s.jsxs(p,{children:["Country ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs(N,{onValueChange:s=>{e.onChange(s),(async e=>{try{const s=await fetch(`https://api.api-ninjas.com/v1/city?country=${e}&limit=30`,{headers:{"X-Api-Key":"YOUR_API_NINJAS_KEY"}}),r=(await s.json()).map((e=>e.name)).sort();T(r),L.setValue("city","")}catch(s){}})(s)},value:e.value,children:[s.jsx(u,{children:s.jsx(w,{children:s.jsx(S,{placeholder:"Select country"})})}),s.jsx(v,{children:O.map((e=>s.jsx(C,{value:e.name,children:e.name},e.code)))})]}),s.jsx(f,{})]})}),s.jsx(x,{control:L.control,name:"city",render:({field:e})=>s.jsxs(h,{children:[s.jsxs(p,{children:["City ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs(N,{onValueChange:e.onChange,value:e.value,disabled:!L.watch("country"),children:[s.jsx(u,{children:s.jsx(w,{children:s.jsx(S,{placeholder:"Select city"})})}),s.jsx(v,{children:V.map((e=>s.jsx(C,{value:e,children:e},e)))})]}),s.jsx(f,{})]})})]}),s.jsx(x,{control:L.control,name:"address",render:({field:e})=>s.jsxs(h,{children:[s.jsxs(p,{children:["Address ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(u,{children:s.jsx(b,{placeholder:"Enter address",...e})}),s.jsx(f,{})]})}),s.jsx(x,{control:L.control,name:"image",render:({field:e})=>s.jsxs(h,{children:[s.jsx(p,{children:"Upload Image"}),s.jsx(u,{children:s.jsx(r,{type:"file",...e,onChange:D})}),s.jsx(f,{})]})}),_&&s.jsxs("div",{className:"mt-4",children:[s.jsx("img",{src:_,alt:"Image preview",className:"w-32 h-32 object-cover rounded-lg"}),s.jsx(a,{type:"button",onClick:()=>k(null),className:"absolute top-0 right-0 bg-red-500 text-white p-1 rounded-full",children:s.jsx(l,{className:"h-4 w-4"})})]}),s.jsx("div",{className:"flex gap-4",children:s.jsx(a,{type:"submit",className:"bg-green-500 w-1/4 font-medium hover:bg-green-600 text-lg",disabled:I,children:"Save"})})]})})})]})]})}export{F as default};
//# sourceMappingURL=SupplierForm-D-4rvEbc.js.map
